ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 1


   1              		.cpu cortex-m3
   2              		.arch armv7-m
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"update_app.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.file 1 "Core/Src/update_app.c"
  18              		.section	.rodata.execute_update_APP_fucntion.str1.4,"aMS",%progbits,1
  19              		.align	2
  20              	.LC0:
  21 0000 0D0A0D0A 		.ascii	"\015\012\015\012download app suceess\000"
  21      646F776E 
  21      6C6F6164 
  21      20617070 
  21      20737563 
  22 0019 000000   		.align	2
  23              	.LC1:
  24 001c 6E6F7420 		.ascii	"not found update_app function\000"
  24      666F756E 
  24      64207570 
  24      64617465 
  24      5F617070 
  25              		.section	.text.execute_update_APP_fucntion,"ax",%progbits
  26              		.align	1
  27              		.syntax unified
  28              		.thumb
  29              		.thumb_func
  31              	execute_update_APP_fucntion:
  32              	.LVL0:
  33              	.LFB5:
   1:Core/Src/update_app.c **** #include "typedef_conf.h"
   2:Core/Src/update_app.c **** #include "uart_printf.h"
   3:Core/Src/update_app.c **** #include "update_app.h"
   4:Core/Src/update_app.c **** #include "stdio.h" //NULL
   5:Core/Src/update_app.c **** #include "string.h"
   6:Core/Src/update_app.c **** #include "uds.h"
   7:Core/Src/update_app.c **** #include "crc.h"
   8:Core/Src/update_app.c **** 
   9:Core/Src/update_app.c **** UPDATE_APP_CONF update_app_conf;
  10:Core/Src/update_app.c **** 
  11:Core/Src/update_app.c **** // 上次命令
  12:Core/Src/update_app.c **** UPDATE_APP_FUNCTION update_app_functions[] = {
  13:Core/Src/update_app.c ****     {0x3101ff00, (app_function)erase_app_start},
  14:Core/Src/update_app.c ****     {0x3103ff00, (app_function)check_erase_app_result},
  15:Core/Src/update_app.c ****     {0x31010203, (app_function)start_install_app},
  16:Core/Src/update_app.c ****     {0x31010202, (app_function)download_app_crc_check},
  17:Core/Src/update_app.c ****     {0x31010205, (app_function)download_finish_CRC_Validate},
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 2


  18:Core/Src/update_app.c ****     {0x34000000, (app_function)pre_download_app},
  19:Core/Src/update_app.c ****     {0x36000000, (app_function)download_app},
  20:Core/Src/update_app.c ****     {0x37000000, (app_function)finish_download_app},
  21:Core/Src/update_app.c **** 
  22:Core/Src/update_app.c **** };
  23:Core/Src/update_app.c **** 
  24:Core/Src/update_app.c **** void init_app_conf()
  25:Core/Src/update_app.c **** {
  26:Core/Src/update_app.c ****     update_app_conf.erase_app_count = 0,
  27:Core/Src/update_app.c ****     update_app_conf.erase_app_start_addr = 0x8002800UL,
  28:Core/Src/update_app.c ****     update_app_conf.erase_app_end_addr = 0x00UL,
  29:Core/Src/update_app.c ****     update_app_conf.download_addr = 0x8002800UL,
  30:Core/Src/update_app.c ****     update_app_conf.erase_app_toal_count = 0,
  31:Core/Src/update_app.c ****     update_app_conf.last_command = 0,
  32:Core/Src/update_app.c ****     update_app_conf.next_command = 0,
  33:Core/Src/update_app.c ****     update_app_conf.command_result = false,
  34:Core/Src/update_app.c ****     update_app_conf.single_package_size = 0X80,
  35:Core/Src/update_app.c ****     update_app_conf.erase_result = 2; // waitchcek
  36:Core/Src/update_app.c ****     update_app_conf.download_finish = false;
  37:Core/Src/update_app.c **** }
  38:Core/Src/update_app.c **** void update_app_start()
  39:Core/Src/update_app.c **** {
  40:Core/Src/update_app.c ****     uart_printf(info_log, "start update app, get app size ", NULL, 0);
  41:Core/Src/update_app.c ****     init_app_conf();
  42:Core/Src/update_app.c ****     calcutate_app_size();
  43:Core/Src/update_app.c **** }
  44:Core/Src/update_app.c **** 
  45:Core/Src/update_app.c **** static void execute_update_APP_fucntion(uint32_t command)
  46:Core/Src/update_app.c **** {
  34              		.loc 1 46 1 view -0
  35              		.cfi_startproc
  36              		@ args = 0, pretend = 0, frame = 8
  37              		@ frame_needed = 0, uses_anonymous_args = 0
  38              		.loc 1 46 1 is_stmt 0 view .LVU1
  39 0000 10B5     		push	{r4, lr}
  40              		.cfi_def_cfa_offset 8
  41              		.cfi_offset 4, -8
  42              		.cfi_offset 14, -4
  43 0002 82B0     		sub	sp, sp, #8
  44              		.cfi_def_cfa_offset 16
  45 0004 0446     		mov	r4, r0
  47:Core/Src/update_app.c ****     uint8_t find_function = false;
  46              		.loc 1 47 5 is_stmt 1 view .LVU2
  47              	.LVL1:
  48:Core/Src/update_app.c ****     for (int i = 0; i < sizeof(update_app_functions) / sizeof(UPDATE_APP_FUNCTION); i++)
  48              		.loc 1 48 5 view .LVU3
  49              	.LBB2:
  50              		.loc 1 48 10 view .LVU4
  51              		.loc 1 48 14 is_stmt 0 view .LVU5
  52 0006 0023     		movs	r3, #0
  53              	.LVL2:
  54              	.L2:
  55              		.loc 1 48 23 is_stmt 1 discriminator 1 view .LVU6
  56 0008 072B     		cmp	r3, #7
  57 000a 0DD8     		bhi	.L9
  49:Core/Src/update_app.c ****     {
  50:Core/Src/update_app.c ****         if (command == (update_app_functions[i].update_app_command))
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 3


  58              		.loc 1 50 9 view .LVU7
  59              		.loc 1 50 48 is_stmt 0 view .LVU8
  60 000c 144A     		ldr	r2, .L13
  61 000e 52F83320 		ldr	r2, [r2, r3, lsl #3]
  62              		.loc 1 50 12 view .LVU9
  63 0012 A242     		cmp	r2, r4
  64 0014 01D0     		beq	.L10
  48:Core/Src/update_app.c ****     for (int i = 0; i < sizeof(update_app_functions) / sizeof(UPDATE_APP_FUNCTION); i++)
  65              		.loc 1 48 86 is_stmt 1 discriminator 2 view .LVU10
  66 0016 0133     		adds	r3, r3, #1
  67              	.LVL3:
  48:Core/Src/update_app.c ****     for (int i = 0; i < sizeof(update_app_functions) / sizeof(UPDATE_APP_FUNCTION); i++)
  68              		.loc 1 48 86 is_stmt 0 discriminator 2 view .LVU11
  69 0018 F6E7     		b	.L2
  70              	.L10:
  51:Core/Src/update_app.c ****         {
  52:Core/Src/update_app.c ****             update_app_functions[i].update_app_function();
  71              		.loc 1 52 13 is_stmt 1 view .LVU12
  72              		.loc 1 52 36 is_stmt 0 view .LVU13
  73 001a 114A     		ldr	r2, .L13
  74 001c 02EBC303 		add	r3, r2, r3, lsl #3
  75              	.LVL4:
  76              		.loc 1 52 36 view .LVU14
  77 0020 5B68     		ldr	r3, [r3, #4]
  78              		.loc 1 52 13 view .LVU15
  79 0022 9847     		blx	r3
  80              	.LVL5:
  53:Core/Src/update_app.c ****             find_function = true;
  81              		.loc 1 53 13 is_stmt 1 view .LVU16
  54:Core/Src/update_app.c ****             break;
  82              		.loc 1 54 13 view .LVU17
  53:Core/Src/update_app.c ****             find_function = true;
  83              		.loc 1 53 27 is_stmt 0 view .LVU18
  84 0024 0123     		movs	r3, #1
  85              		.loc 1 54 13 view .LVU19
  86 0026 00E0     		b	.L4
  87              	.LVL6:
  88              	.L9:
  89              		.loc 1 54 13 view .LVU20
  90              	.LBE2:
  47:Core/Src/update_app.c ****     for (int i = 0; i < sizeof(update_app_functions) / sizeof(UPDATE_APP_FUNCTION); i++)
  91              		.loc 1 47 13 view .LVU21
  92 0028 0023     		movs	r3, #0
  93              	.LVL7:
  94              	.L4:
  55:Core/Src/update_app.c ****         }
  56:Core/Src/update_app.c ****     }
  57:Core/Src/update_app.c ****     if (command == 0x66666666)
  95              		.loc 1 57 5 is_stmt 1 view .LVU22
  96              		.loc 1 57 8 is_stmt 0 view .LVU23
  97 002a B4F1663F 		cmp	r4, #1717986918
  98 002e 02D0     		beq	.L11
  58:Core/Src/update_app.c ****     {
  59:Core/Src/update_app.c ****         uart_printf(error_log, "\r\n\r\ndownload app suceess", NULL, 0);
  60:Core/Src/update_app.c ****     }
  61:Core/Src/update_app.c ****     else if (find_function == false)
  99              		.loc 1 61 10 is_stmt 1 view .LVU24
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 4


 100              		.loc 1 61 13 is_stmt 0 view .LVU25
 101 0030 43B1     		cbz	r3, .L12
 102              	.LVL8:
 103              	.L1:
  62:Core/Src/update_app.c ****     {
  63:Core/Src/update_app.c ****         uint8_t data_to_uint8_t[4] = {0};
  64:Core/Src/update_app.c ****         convert_uint32_t_to_uint8_t(command, data_to_uint8_t);
  65:Core/Src/update_app.c ****         uart_printf(error_log, "not found update_app function", data_to_uint8_t, 4);
  66:Core/Src/update_app.c ****     }
  67:Core/Src/update_app.c **** }
 104              		.loc 1 67 1 view .LVU26
 105 0032 02B0     		add	sp, sp, #8
 106              		.cfi_remember_state
 107              		.cfi_def_cfa_offset 8
 108              		@ sp needed
 109 0034 10BD     		pop	{r4, pc}
 110              	.LVL9:
 111              	.L11:
 112              		.cfi_restore_state
  59:Core/Src/update_app.c ****     }
 113              		.loc 1 59 9 is_stmt 1 view .LVU27
 114 0036 0023     		movs	r3, #0
 115              	.LVL10:
  59:Core/Src/update_app.c ****     }
 116              		.loc 1 59 9 is_stmt 0 view .LVU28
 117 0038 1A46     		mov	r2, r3
 118 003a 0A49     		ldr	r1, .L13+4
 119 003c 0420     		movs	r0, #4
 120 003e FFF7FEFF 		bl	uart_printf
 121              	.LVL11:
 122 0042 F6E7     		b	.L1
 123              	.LVL12:
 124              	.L12:
 125              	.LBB3:
  63:Core/Src/update_app.c ****         convert_uint32_t_to_uint8_t(command, data_to_uint8_t);
 126              		.loc 1 63 9 is_stmt 1 view .LVU29
  63:Core/Src/update_app.c ****         convert_uint32_t_to_uint8_t(command, data_to_uint8_t);
 127              		.loc 1 63 17 is_stmt 0 view .LVU30
 128 0044 0193     		str	r3, [sp, #4]
  64:Core/Src/update_app.c ****         uart_printf(error_log, "not found update_app function", data_to_uint8_t, 4);
 129              		.loc 1 64 9 is_stmt 1 view .LVU31
 130 0046 01A9     		add	r1, sp, #4
 131 0048 2046     		mov	r0, r4
 132 004a FFF7FEFF 		bl	convert_uint32_t_to_uint8_t
 133              	.LVL13:
  65:Core/Src/update_app.c ****     }
 134              		.loc 1 65 9 view .LVU32
 135 004e 0423     		movs	r3, #4
 136 0050 0DEB0302 		add	r2, sp, r3
 137 0054 0449     		ldr	r1, .L13+8
 138 0056 1846     		mov	r0, r3
 139 0058 FFF7FEFF 		bl	uart_printf
 140              	.LVL14:
 141              	.LBE3:
 142              		.loc 1 67 1 is_stmt 0 view .LVU33
 143 005c E9E7     		b	.L1
 144              	.L14:
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 5


 145 005e 00BF     		.align	2
 146              	.L13:
 147 0060 00000000 		.word	update_app_functions
 148 0064 00000000 		.word	.LC0
 149 0068 1C000000 		.word	.LC1
 150              		.cfi_endproc
 151              	.LFE5:
 153              		.section	.text.download_app,"ax",%progbits
 154              		.align	1
 155              		.global	download_app
 156              		.syntax unified
 157              		.thumb
 158              		.thumb_func
 160              	download_app:
 161              	.LFB11:
  68:Core/Src/update_app.c **** 
  69:Core/Src/update_app.c **** void update_app_entry(uint8_t *data, uint16_t dataLen)
  70:Core/Src/update_app.c **** {
  71:Core/Src/update_app.c **** 
  72:Core/Src/update_app.c ****     for (int i = 0; i < 72000; i++)
  73:Core/Src/update_app.c ****     { // 延时，
  74:Core/Src/update_app.c ****     }
  75:Core/Src/update_app.c ****     uart_printf(system_log, "update_app_entry ", data, dataLen);
  76:Core/Src/update_app.c **** 
  77:Core/Src/update_app.c ****     uint8_t temp_data = (update_app_conf.last_command >> 24);
  78:Core/Src/update_app.c **** 
  79:Core/Src/update_app.c ****     // 检查服务是不是正反馈
  80:Core/Src/update_app.c ****     if (data[0] != (temp_data + 0x40))
  81:Core/Src/update_app.c ****     {
  82:Core/Src/update_app.c ****         // 检查是不是30 、3e 80、7f xx 78
  83:Core/Src/update_app.c ****         if (data[0] == 0x30 || data[0] == 0x3e || ((data[0] == 0x7f) && (data[2] == 0x78)))
  84:Core/Src/update_app.c ****         {
  85:Core/Src/update_app.c ****             // wait
  86:Core/Src/update_app.c ****         }
  87:Core/Src/update_app.c ****         else
  88:Core/Src/update_app.c ****         {
  89:Core/Src/update_app.c ****             uart_printf(error_log, "retry", &update_app_conf.retry_count, 1);
  90:Core/Src/update_app.c ****             update_app_conf.retry_count++;
  91:Core/Src/update_app.c ****             if (update_app_conf.retry_count >= 3)
  92:Core/Src/update_app.c ****             {
  93:Core/Src/update_app.c **** 
  94:Core/Src/update_app.c ****                 uart_printf(error_log, "retry  failed ......\r\n", NULL, 0);
  95:Core/Src/update_app.c ****                 return;
  96:Core/Src/update_app.c ****             }
  97:Core/Src/update_app.c ****             update_app_conf.command_result = false;
  98:Core/Src/update_app.c ****             execute_update_APP_fucntion(update_app_conf.last_command);
  99:Core/Src/update_app.c ****         }
 100:Core/Src/update_app.c ****     }
 101:Core/Src/update_app.c ****     else // 下一步命令
 102:Core/Src/update_app.c ****     {
 103:Core/Src/update_app.c ****         if (data[0] == 0x74)
 104:Core/Src/update_app.c ****         {
 105:Core/Src/update_app.c ****             update_app_conf.response_package_size = data[2];
 106:Core/Src/update_app.c ****         }
 107:Core/Src/update_app.c ****         execute_update_APP_fucntion(update_app_conf.next_command);
 108:Core/Src/update_app.c ****         update_app_conf.command_result = true;
 109:Core/Src/update_app.c ****     }
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 6


 110:Core/Src/update_app.c **** }
 111:Core/Src/update_app.c **** 
 112:Core/Src/update_app.c **** void calcutate_app_size(void)
 113:Core/Src/update_app.c **** {
 114:Core/Src/update_app.c ****     uint32_t *APP_start_address = (uint32_t *)0x8002800UL;
 115:Core/Src/update_app.c ****     uint32_t APPSize = 0;
 116:Core/Src/update_app.c **** 
 117:Core/Src/update_app.c ****     uint8_t date_to_uint8_t[4] = {0};
 118:Core/Src/update_app.c ****     // 计算app所占的字节数
 119:Core/Src/update_app.c ****     while (*APP_start_address != 0xFFFFFFFF)
 120:Core/Src/update_app.c ****     {
 121:Core/Src/update_app.c ****         APPSize += 4;
 122:Core/Src/update_app.c ****         APP_start_address++;
 123:Core/Src/update_app.c ****     }
 124:Core/Src/update_app.c **** 
 125:Core/Src/update_app.c ****     convert_uint32_t_to_uint8_t(APPSize, date_to_uint8_t);
 126:Core/Src/update_app.c ****     uart_printf(info_log, "the app size is: ", date_to_uint8_t, 4);
 127:Core/Src/update_app.c ****     update_app_conf.erase_app_end_addr = 0x8002800UL + APPSize;
 128:Core/Src/update_app.c ****     // 计算需要擦写的block数量
 129:Core/Src/update_app.c ****     uint8_t bootloader_erase_block_count = APPSize / 1024;
 130:Core/Src/update_app.c **** 
 131:Core/Src/update_app.c ****     if (APPSize % 1024 != 0)
 132:Core/Src/update_app.c ****     {
 133:Core/Src/update_app.c ****         bootloader_erase_block_count += 1;
 134:Core/Src/update_app.c ****     }
 135:Core/Src/update_app.c ****     uart_printf(info_log, "bootloader need erase block count is: ", &bootloader_erase_block_count, 
 136:Core/Src/update_app.c **** 
 137:Core/Src/update_app.c ****     update_app_conf.erase_app_toal_count = bootloader_erase_block_count;
 138:Core/Src/update_app.c **** 
 139:Core/Src/update_app.c ****     erase_app_start();
 140:Core/Src/update_app.c **** }
 141:Core/Src/update_app.c **** 
 142:Core/Src/update_app.c **** void erase_app_start(void)
 143:Core/Src/update_app.c **** {
 144:Core/Src/update_app.c ****     uint8_t data_to_uint8_t[4] = {0};
 145:Core/Src/update_app.c ****     uint8_t uds_data[8] = {0x31, 0x01, 0xff, 0x00};
 146:Core/Src/update_app.c ****     uint32_t erase_address = 0;
 147:Core/Src/update_app.c **** 
 148:Core/Src/update_app.c ****     // 设置上次执行命令
 149:Core/Src/update_app.c ****     update_app_conf.last_command = 0x3101ff00;
 150:Core/Src/update_app.c **** 
 151:Core/Src/update_app.c ****     // 继续擦写
 152:Core/Src/update_app.c ****     update_app_conf.next_command = 0x3101ff00;
 153:Core/Src/update_app.c **** 
 154:Core/Src/update_app.c ****     // 上次擦除失败
 155:Core/Src/update_app.c ****     if (update_app_conf.command_result == false)
 156:Core/Src/update_app.c ****     {
 157:Core/Src/update_app.c ****         // 尝试再次擦写
 158:Core/Src/update_app.c ****         erase_address = update_app_conf.erase_app_start_addr + update_app_conf.erase_app_count * 10
 159:Core/Src/update_app.c **** 
 160:Core/Src/update_app.c ****         // retry times
 161:Core/Src/update_app.c ****     }
 162:Core/Src/update_app.c ****     else // 上次执行擦除成功
 163:Core/Src/update_app.c ****     {
 164:Core/Src/update_app.c ****         // 已经擦除完所有block 执行下一步 检查擦写结果
 165:Core/Src/update_app.c ****         if (update_app_conf.erase_app_count == update_app_conf.erase_app_toal_count)
 166:Core/Src/update_app.c ****         {
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 7


 167:Core/Src/update_app.c ****             check_erase_app_result();
 168:Core/Src/update_app.c ****             return;
 169:Core/Src/update_app.c ****         }
 170:Core/Src/update_app.c ****         else // 继续擦写
 171:Core/Src/update_app.c ****         {
 172:Core/Src/update_app.c ****             // 擦写的块计数
 173:Core/Src/update_app.c ****             update_app_conf.erase_app_count++;
 174:Core/Src/update_app.c ****             // 本次擦写地址
 175:Core/Src/update_app.c ****             erase_address = update_app_conf.erase_app_start_addr + update_app_conf.erase_app_count 
 176:Core/Src/update_app.c ****         }
 177:Core/Src/update_app.c ****     }
 178:Core/Src/update_app.c ****     uart_printf(info_log, "erase count ", &update_app_conf.erase_app_count, 1);
 179:Core/Src/update_app.c ****     convert_uint32_t_to_uint8_t(erase_address, data_to_uint8_t);
 180:Core/Src/update_app.c ****     uart_printf(info_log, "erase address ", data_to_uint8_t, 4);
 181:Core/Src/update_app.c ****     // 擦写的地址插入到uds命令
 182:Core/Src/update_app.c ****     memcpy(uds_data + 4, data_to_uint8_t, 4);
 183:Core/Src/update_app.c ****     // 调用tx 发送到bootloader
 184:Core/Src/update_app.c ****     can_service_response(uds_data, 8);
 185:Core/Src/update_app.c **** }
 186:Core/Src/update_app.c **** 
 187:Core/Src/update_app.c **** void check_erase_app_result(void)
 188:Core/Src/update_app.c **** {
 189:Core/Src/update_app.c ****     uint8_t uds_data[12] = {0x31, 0x03, 0xff, 0x00};
 190:Core/Src/update_app.c ****     // 下次执行检查擦写结果
 191:Core/Src/update_app.c ****     update_app_conf.next_command = 0x3103ff00;
 192:Core/Src/update_app.c ****     // 检查失败需要交给 check_erase_app_result处理
 193:Core/Src/update_app.c ****     update_app_conf.last_command = 0x3103ff00;
 194:Core/Src/update_app.c **** 
 195:Core/Src/update_app.c ****     if (update_app_conf.erase_result == 2) // 需要发送bootloader检查请求
 196:Core/Src/update_app.c ****     {
 197:Core/Src/update_app.c ****         convert_uint32_t_to_uint8_t(update_app_conf.erase_app_start_addr, uds_data + 4);
 198:Core/Src/update_app.c ****         convert_uint32_t_to_uint8_t(update_app_conf.erase_app_end_addr, uds_data + 8);
 199:Core/Src/update_app.c ****         update_app_conf.erase_result = 1; // 等待bootloader 反馈
 200:Core/Src/update_app.c ****         can_service_response(uds_data, 12);
 201:Core/Src/update_app.c ****     }
 202:Core/Src/update_app.c ****     else if (update_app_conf.erase_result == 1) // 检查vip 反馈结果
 203:Core/Src/update_app.c ****     {
 204:Core/Src/update_app.c ****         if (update_app_conf.command_result == true)
 205:Core/Src/update_app.c ****         {
 206:Core/Src/update_app.c ****             // 执行34服务
 207:Core/Src/update_app.c ****             uart_printf(info_log, "erase app success\r\n", NULL, 0);
 208:Core/Src/update_app.c ****             update_app_conf.command_result = false; // 34服务要用到
 209:Core/Src/update_app.c ****             pre_download_app();
 210:Core/Src/update_app.c ****         }
 211:Core/Src/update_app.c ****         else
 212:Core/Src/update_app.c ****         {
 213:Core/Src/update_app.c ****             //  do nothing
 214:Core/Src/update_app.c ****             uart_printf(info_log, "erase app fail\r\n", NULL, 0);
 215:Core/Src/update_app.c ****         }
 216:Core/Src/update_app.c ****     }
 217:Core/Src/update_app.c **** }
 218:Core/Src/update_app.c **** 
 219:Core/Src/update_app.c **** void pre_download_app() // 34服务告诉bootloader下载参数
 220:Core/Src/update_app.c **** {
 221:Core/Src/update_app.c **** 
 222:Core/Src/update_app.c ****     update_app_conf.last_command = 0x34000000;
 223:Core/Src/update_app.c ****     uint8_t uds_data[8] = {0x34, 0x00, 0x14};    // memory size 1字节 memory address 4字节
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 8


 224:Core/Src/update_app.c ****     update_app_conf.package_count = 0;           // 包计数清零
 225:Core/Src/update_app.c ****     if (update_app_conf.command_result == false) // 上次执行fail
 226:Core/Src/update_app.c ****     {
 227:Core/Src/update_app.c ****         // retry
 228:Core/Src/update_app.c ****         convert_uint32_t_to_uint8_t(update_app_conf.download_addr, &uds_data[4]); // 下载地址
 229:Core/Src/update_app.c ****     }
 230:Core/Src/update_app.c ****     else
 231:Core/Src/update_app.c ****     {
 232:Core/Src/update_app.c ****         if (update_app_conf.download_finish == true) // 下载完成所有包
 233:Core/Src/update_app.c ****         {
 234:Core/Src/update_app.c ****             // update_app_conf.download_finish = true; // 标记为下载完成， 进行整体CRC
 235:Core/Src/update_app.c ****             uart_printf(info_log, "download app finish,start crc\r\n", NULL, 0);
 236:Core/Src/update_app.c ****             download_finish_CRC_Validate();
 237:Core/Src/update_app.c ****             return;
 238:Core/Src/update_app.c ****         }
 239:Core/Src/update_app.c ****         update_app_conf.download_addr += update_app_conf.single_package_size; // 下载地址后移
 240:Core/Src/update_app.c ****         // 检查是不是下载到边界
 241:Core/Src/update_app.c ****         if (update_app_conf.download_addr + update_app_conf.single_package_size > update_app_conf.e
 242:Core/Src/update_app.c ****         {
 243:Core/Src/update_app.c ****             // 设置最后一包的大小的下载大小
 244:Core/Src/update_app.c ****             update_app_conf.single_package_size = update_app_conf.erase_app_end_addr - update_app_c
 245:Core/Src/update_app.c ****             // update_app_conf.download_addr = update_app_conf.erase_app_end_addr;
 246:Core/Src/update_app.c ****             update_app_conf.download_finish = true; // 标记为下载完成， 进行整体CRC
 247:Core/Src/update_app.c ****         }
 248:Core/Src/update_app.c ****         convert_uint32_t_to_uint8_t(update_app_conf.download_addr, &uds_data[4]);
 249:Core/Src/update_app.c ****     }
 250:Core/Src/update_app.c ****     // 发送长度
 251:Core/Src/update_app.c ****     uds_data[3] = update_app_conf.single_package_size;
 252:Core/Src/update_app.c ****     uart_printf(info_log, "pre download address ", &uds_data[3], 4);
 253:Core/Src/update_app.c ****     // 36请求下载
 254:Core/Src/update_app.c ****     update_app_conf.next_command = 0x36000000;
 255:Core/Src/update_app.c **** 
 256:Core/Src/update_app.c ****     uint32_t rest_size = update_app_conf.erase_app_end_addr - update_app_conf.download_addr;
 257:Core/Src/update_app.c **** 
 258:Core/Src/update_app.c ****     uint8_t temp[4];
 259:Core/Src/update_app.c ****     convert_uint32_t_to_uint8_t(rest_size, temp);
 260:Core/Src/update_app.c ****     uart_printf(system_log, "----------------------download rest size-------------------------: ", 
 261:Core/Src/update_app.c ****     can_service_response(uds_data, 8);
 262:Core/Src/update_app.c **** }
 263:Core/Src/update_app.c **** 
 264:Core/Src/update_app.c **** // 36服务
 265:Core/Src/update_app.c **** void download_app()
 266:Core/Src/update_app.c **** {
 162              		.loc 1 266 1 is_stmt 1 view -0
 163              		.cfi_startproc
 164              		@ args = 0, pretend = 0, frame = 0
 165              		@ frame_needed = 1, uses_anonymous_args = 0
 166 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 167              		.cfi_def_cfa_offset 24
 168              		.cfi_offset 4, -24
 169              		.cfi_offset 5, -20
 170              		.cfi_offset 6, -16
 171              		.cfi_offset 7, -12
 172              		.cfi_offset 8, -8
 173              		.cfi_offset 14, -4
 174 0004 00AF     		add	r7, sp, #0
 175              		.cfi_def_cfa_register 7
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 9


 267:Core/Src/update_app.c ****     // 36服务失败 交给34?
 268:Core/Src/update_app.c ****     update_app_conf.last_command = 0x36000000;
 176              		.loc 1 268 5 view .LVU35
 177              		.loc 1 268 34 is_stmt 0 view .LVU36
 178 0006 324B     		ldr	r3, .L24
 179 0008 4FF05852 		mov	r2, #905969664
 180 000c 1A61     		str	r2, [r3, #16]
 269:Core/Src/update_app.c ****     // update_app_conf.next_command = 0x37000000;
 270:Core/Src/update_app.c ****     if (update_app_conf.last_command == false)
 181              		.loc 1 270 5 is_stmt 1 view .LVU37
 271:Core/Src/update_app.c ****     {
 272:Core/Src/update_app.c ****         pre_download_app();
 273:Core/Src/update_app.c ****     }
 274:Core/Src/update_app.c **** 
 275:Core/Src/update_app.c ****     /* 一次发完*/
 276:Core/Src/update_app.c ****     // uint8_t uds_data[update_app_conf.single_package_size + 2];
 277:Core/Src/update_app.c ****     // uds_data[0] = 0x36;
 278:Core/Src/update_app.c ****     // uds_data[1] = 0x01;
 279:Core/Src/update_app.c ****     // uint32_t *flash_data = (uint32_t *)update_app_conf.download_addr;
 280:Core/Src/update_app.c **** 
 281:Core/Src/update_app.c ****     // for (uint8_t i = 0; i < update_app_conf.single_package_size / 4; i++)
 282:Core/Src/update_app.c ****     // {
 283:Core/Src/update_app.c ****     //     convert_uint32_t_to_uint8_t(*flash_data, &uds_data[2 + i * 4]);
 284:Core/Src/update_app.c ****     //     flash_data++;
 285:Core/Src/update_app.c ****     // }
 286:Core/Src/update_app.c ****     // uart_printf(info_log, "download data\r\n", NULL, 0);
 287:Core/Src/update_app.c **** 
 288:Core/Src/update_app.c ****     // can_service_response(uds_data, update_app_conf.single_package_size + 2);
 289:Core/Src/update_app.c **** 
 290:Core/Src/update_app.c ****     /*根据34服务反馈的一包大小进行发送*/
 291:Core/Src/update_app.c ****     uint8_t uds_data[update_app_conf.response_package_size + 2];
 182              		.loc 1 291 5 view .LVU38
 183              		.loc 1 291 37 is_stmt 0 view .LVU39
 184 000e 597F     		ldrb	r1, [r3, #29]	@ zero_extendqisi2
 185              	.LVL15:
 186              		.loc 1 291 13 view .LVU40
 187 0010 01F10902 		add	r2, r1, #9
 188 0014 02F4FC72 		and	r2, r2, #504
 189 0018 ADEB020D 		sub	sp, sp, r2
 190 001c 6D46     		mov	r5, sp
 191              	.LVL16:
 292:Core/Src/update_app.c ****     uint8_t package_total_count; // 传包总数
 192              		.loc 1 292 5 is_stmt 1 view .LVU41
 293:Core/Src/update_app.c ****     // uint8_t package_count = 0x01; // 包计数
 294:Core/Src/update_app.c **** 
 295:Core/Src/update_app.c ****     // 计算36服务传包是整包数
 296:Core/Src/update_app.c ****     package_total_count = update_app_conf.single_package_size / update_app_conf.response_package_si
 193              		.loc 1 296 5 view .LVU42
 194              		.loc 1 296 42 is_stmt 0 view .LVU43
 195 001e DA7E     		ldrb	r2, [r3, #27]	@ zero_extendqisi2
 196              		.loc 1 296 25 view .LVU44
 197 0020 B2FBF1F2 		udiv	r2, r2, r1
 198              	.LVL17:
 297:Core/Src/update_app.c ****     uds_data[0] = 0x36;
 199              		.loc 1 297 5 is_stmt 1 view .LVU45
 200              		.loc 1 297 17 is_stmt 0 view .LVU46
 201 0024 3621     		movs	r1, #54
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 10


 202              	.LVL18:
 203              		.loc 1 297 17 view .LVU47
 204 0026 8DF80010 		strb	r1, [sp]
 298:Core/Src/update_app.c ****     uds_data[1] = update_app_conf.package_count + 1;
 205              		.loc 1 298 5 is_stmt 1 view .LVU48
 206              		.loc 1 298 34 is_stmt 0 view .LVU49
 207 002a 187F     		ldrb	r0, [r3, #28]	@ zero_extendqisi2
 208              		.loc 1 298 49 view .LVU50
 209 002c 431C     		adds	r3, r0, #1
 210              		.loc 1 298 17 view .LVU51
 211 002e 8DF80130 		strb	r3, [sp, #1]
 299:Core/Src/update_app.c ****     // 当前传包是满足34返回的整包
 300:Core/Src/update_app.c ****     if (update_app_conf.package_count < package_total_count)
 212              		.loc 1 300 5 is_stmt 1 view .LVU52
 213              		.loc 1 300 8 is_stmt 0 view .LVU53
 214 0032 9042     		cmp	r0, r2
 215 0034 21D2     		bcs	.L16
 216              	.LBB4:
 301:Core/Src/update_app.c ****     {
 302:Core/Src/update_app.c ****         uint32_t *flash_data = (uint32_t *)(update_app_conf.download_addr + update_app_conf.package
 217              		.loc 1 302 9 is_stmt 1 view .LVU54
 218              		.loc 1 302 60 is_stmt 0 view .LVU55
 219 0036 264B     		ldr	r3, .L24
 220 0038 5E68     		ldr	r6, [r3, #4]
 221              		.loc 1 302 124 view .LVU56
 222 003a 5B7F     		ldrb	r3, [r3, #29]	@ zero_extendqisi2
 223              	.LVL19:
 224              		.loc 1 302 75 view .LVU57
 225 003c 03FB0066 		mla	r6, r3, r0, r6
 226              	.LVL20:
 303:Core/Src/update_app.c **** 
 304:Core/Src/update_app.c ****         for (uint8_t i = 0; i < update_app_conf.response_package_size / 4; i++)
 227              		.loc 1 304 9 is_stmt 1 view .LVU58
 228              	.LBB5:
 229              		.loc 1 304 14 view .LVU59
 230              		.loc 1 304 22 is_stmt 0 view .LVU60
 231 0040 0024     		movs	r4, #0
 232              		.loc 1 304 9 view .LVU61
 233 0042 08E0     		b	.L17
 234              	.LVL21:
 235              	.L18:
 305:Core/Src/update_app.c ****         {
 306:Core/Src/update_app.c ****             convert_uint32_t_to_uint8_t(*flash_data, &uds_data[2 + i * 4]);
 236              		.loc 1 306 13 is_stmt 1 view .LVU62
 237              		.loc 1 306 70 is_stmt 0 view .LVU63
 238 0044 A100     		lsls	r1, r4, #2
 239              		.loc 1 306 66 view .LVU64
 240 0046 0231     		adds	r1, r1, #2
 241              		.loc 1 306 13 view .LVU65
 242 0048 2944     		add	r1, r1, r5
 243 004a 56F8040B 		ldr	r0, [r6], #4
 244              	.LVL22:
 245              		.loc 1 306 13 view .LVU66
 246 004e FFF7FEFF 		bl	convert_uint32_t_to_uint8_t
 247              	.LVL23:
 307:Core/Src/update_app.c ****             flash_data++;
 248              		.loc 1 307 13 is_stmt 1 view .LVU67
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 11


 304:Core/Src/update_app.c ****         {
 249              		.loc 1 304 77 discriminator 3 view .LVU68
 250 0052 0134     		adds	r4, r4, #1
 251              	.LVL24:
 304:Core/Src/update_app.c ****         {
 252              		.loc 1 304 77 is_stmt 0 discriminator 3 view .LVU69
 253 0054 E4B2     		uxtb	r4, r4
 254              	.LVL25:
 255              	.L17:
 304:Core/Src/update_app.c ****         {
 256              		.loc 1 304 31 is_stmt 1 discriminator 1 view .LVU70
 304:Core/Src/update_app.c ****         {
 257              		.loc 1 304 48 is_stmt 0 discriminator 1 view .LVU71
 258 0056 1E4B     		ldr	r3, .L24
 259 0058 597F     		ldrb	r1, [r3, #29]	@ zero_extendqisi2
 304:Core/Src/update_app.c ****         {
 260              		.loc 1 304 31 discriminator 1 view .LVU72
 261 005a B4EB910F 		cmp	r4, r1, lsr #2
 262 005e F1D3     		bcc	.L18
 304:Core/Src/update_app.c ****         {
 263              		.loc 1 304 31 discriminator 1 view .LVU73
 264              	.LBE5:
 308:Core/Src/update_app.c ****         }
 309:Core/Src/update_app.c ****         update_app_conf.package_count++;
 265              		.loc 1 309 9 is_stmt 1 view .LVU74
 266              		.loc 1 309 24 is_stmt 0 view .LVU75
 267 0060 1A7F     		ldrb	r2, [r3, #28]	@ zero_extendqisi2
 268              		.loc 1 309 38 view .LVU76
 269 0062 0132     		adds	r2, r2, #1
 270 0064 1A77     		strb	r2, [r3, #28]
 310:Core/Src/update_app.c **** 
 311:Core/Src/update_app.c ****         // 36一包没有发送完毕，下一包继续由36发送
 312:Core/Src/update_app.c ****         update_app_conf.next_command = 0x36000000;
 271              		.loc 1 312 9 is_stmt 1 view .LVU77
 272              		.loc 1 312 38 is_stmt 0 view .LVU78
 273 0066 4FF05852 		mov	r2, #905969664
 274 006a 5A61     		str	r2, [r3, #20]
 313:Core/Src/update_app.c ****         // 发送到bootloader
 314:Core/Src/update_app.c ****         can_service_response(uds_data, update_app_conf.response_package_size + 2);
 275              		.loc 1 314 9 is_stmt 1 view .LVU79
 276 006c 0231     		adds	r1, r1, #2
 277 006e 2846     		mov	r0, r5
 278 0070 FFF7FEFF 		bl	can_service_response
 279              	.LVL26:
 280              	.L15:
 281              		.loc 1 314 9 is_stmt 0 view .LVU80
 282              	.LBE4:
 315:Core/Src/update_app.c ****     }
 316:Core/Src/update_app.c ****     // 当前包不满足34反馈包大小
 317:Core/Src/update_app.c ****     else if (update_app_conf.single_package_size % update_app_conf.response_package_size != 0)
 318:Core/Src/update_app.c ****     {
 319:Core/Src/update_app.c ****         uint32_t *flash_data = (uint32_t *)(update_app_conf.download_addr + update_app_conf.package
 320:Core/Src/update_app.c **** 
 321:Core/Src/update_app.c ****         uint8_t rest_data_size = update_app_conf.single_package_size - update_app_conf.response_pac
 322:Core/Src/update_app.c **** 
 323:Core/Src/update_app.c ****         for (uint8_t i = 0; i < rest_data_size / 4; i++)
 324:Core/Src/update_app.c ****         {
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 12


 325:Core/Src/update_app.c ****             convert_uint32_t_to_uint8_t(*flash_data, &uds_data[2 + i * 4]);
 326:Core/Src/update_app.c ****             flash_data++;
 327:Core/Src/update_app.c ****         }
 328:Core/Src/update_app.c ****         // 36一包发送完毕，
 329:Core/Src/update_app.c ****         update_app_conf.next_command = 0x37000000;
 330:Core/Src/update_app.c ****         // 发送到bootloader
 331:Core/Src/update_app.c ****         can_service_response(uds_data, rest_data_size + 2);
 332:Core/Src/update_app.c ****     }
 333:Core/Src/update_app.c **** 
 334:Core/Src/update_app.c ****     // // 一包大小满足34反馈大小
 335:Core/Src/update_app.c ****     // for (uint8_t i = 0; i < package_total_count; i++)
 336:Core/Src/update_app.c ****     // {
 337:Core/Src/update_app.c ****     //     uds_data[0] = 0x36;
 338:Core/Src/update_app.c ****     //     uds_data[1] = package_count;
 339:Core/Src/update_app.c ****     //     for (uint8_t j = 0; j < update_app_conf.response_package_size / 4; j++)
 340:Core/Src/update_app.c ****     //     {
 341:Core/Src/update_app.c ****     //         convert_uint32_t_to_uint8_t(*flash_data, &uds_data[2 + j * 4]);
 342:Core/Src/update_app.c ****     //         flash_data++;
 343:Core/Src/update_app.c ****     //     }
 344:Core/Src/update_app.c ****     //     // 发送到bootloader
 345:Core/Src/update_app.c ****     //     package_count++;
 346:Core/Src/update_app.c ****     //     can_service_response(uds_data, update_app_conf.response_package_size + 2);
 347:Core/Src/update_app.c ****     // }
 348:Core/Src/update_app.c ****     // // 一包大小小于34反馈大小
 349:Core/Src/update_app.c ****     // if (update_app_conf.single_package_size % update_app_conf.response_package_size != 0)
 350:Core/Src/update_app.c ****     // {
 351:Core/Src/update_app.c ****     //     // package_total_count++;
 352:Core/Src/update_app.c ****     //     uds_data[0] = 0x36;
 353:Core/Src/update_app.c ****     //     uds_data[1] = package_count;
 354:Core/Src/update_app.c **** 
 355:Core/Src/update_app.c ****     //     uint8_t rest_data_size = update_app_conf.single_package_size -
 356:Core/Src/update_app.c ****     //                              update_app_conf.response_package_size * package_total_count;
 357:Core/Src/update_app.c **** 
 358:Core/Src/update_app.c ****     //     for (size_t i = 0; i < rest_data_size / 4; i++)
 359:Core/Src/update_app.c ****     //     {
 360:Core/Src/update_app.c ****     //         convert_uint32_t_to_uint8_t(*flash_data, &uds_data[2 + i * 4]);
 361:Core/Src/update_app.c ****     //         flash_data++;
 362:Core/Src/update_app.c ****     //     }
 363:Core/Src/update_app.c ****     //     can_service_response(uds_data, rest_data_size + 2);
 364:Core/Src/update_app.c ****     // }
 365:Core/Src/update_app.c **** }
 283              		.loc 1 365 1 view .LVU81
 284 0074 BD46     		mov	sp, r7
 285              		.cfi_remember_state
 286              		.cfi_def_cfa_register 13
 287              		@ sp needed
 288 0076 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 289              	.LVL27:
 290              	.L16:
 291              		.cfi_restore_state
 317:Core/Src/update_app.c ****     {
 292              		.loc 1 317 10 is_stmt 1 view .LVU82
 317:Core/Src/update_app.c ****     {
 293              		.loc 1 317 29 is_stmt 0 view .LVU83
 294 007a 154B     		ldr	r3, .L24
 295 007c DE7E     		ldrb	r6, [r3, #27]	@ zero_extendqisi2
 317:Core/Src/update_app.c ****     {
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 13


 296              		.loc 1 317 67 view .LVU84
 297 007e 5B7F     		ldrb	r3, [r3, #29]	@ zero_extendqisi2
 317:Core/Src/update_app.c ****     {
 298              		.loc 1 317 90 view .LVU85
 299 0080 B6FBF3F1 		udiv	r1, r6, r3
 300 0084 03FB1161 		mls	r1, r3, r1, r6
 317:Core/Src/update_app.c ****     {
 301              		.loc 1 317 13 view .LVU86
 302 0088 11F0FF0F 		tst	r1, #255
 303 008c F2D0     		beq	.L15
 304              	.LBB6:
 319:Core/Src/update_app.c **** 
 305              		.loc 1 319 9 is_stmt 1 view .LVU87
 319:Core/Src/update_app.c **** 
 306              		.loc 1 319 60 is_stmt 0 view .LVU88
 307 008e 1049     		ldr	r1, .L24
 308 0090 4968     		ldr	r1, [r1, #4]
 319:Core/Src/update_app.c **** 
 309              		.loc 1 319 75 view .LVU89
 310 0092 03FB0018 		mla	r8, r3, r0, r1
 311              	.LVL28:
 321:Core/Src/update_app.c **** 
 312              		.loc 1 321 9 is_stmt 1 view .LVU90
 321:Core/Src/update_app.c **** 
 313              		.loc 1 321 110 is_stmt 0 view .LVU91
 314 0096 02FB03F3 		mul	r3, r2, r3
 315 009a DBB2     		uxtb	r3, r3
 321:Core/Src/update_app.c **** 
 316              		.loc 1 321 17 view .LVU92
 317 009c F61A     		subs	r6, r6, r3
 318 009e F6B2     		uxtb	r6, r6
 319              	.LVL29:
 323:Core/Src/update_app.c ****         {
 320              		.loc 1 323 9 is_stmt 1 view .LVU93
 321              	.LBB7:
 323:Core/Src/update_app.c ****         {
 322              		.loc 1 323 14 view .LVU94
 323:Core/Src/update_app.c ****         {
 323              		.loc 1 323 22 is_stmt 0 view .LVU95
 324 00a0 0024     		movs	r4, #0
 325              	.LVL30:
 326              	.L20:
 323:Core/Src/update_app.c ****         {
 327              		.loc 1 323 31 is_stmt 1 discriminator 1 view .LVU96
 328 00a2 B4EB960F 		cmp	r4, r6, lsr #2
 329 00a6 09D2     		bcs	.L23
 325:Core/Src/update_app.c ****             flash_data++;
 330              		.loc 1 325 13 view .LVU97
 325:Core/Src/update_app.c ****             flash_data++;
 331              		.loc 1 325 70 is_stmt 0 view .LVU98
 332 00a8 A100     		lsls	r1, r4, #2
 325:Core/Src/update_app.c ****             flash_data++;
 333              		.loc 1 325 66 view .LVU99
 334 00aa 0231     		adds	r1, r1, #2
 325:Core/Src/update_app.c ****             flash_data++;
 335              		.loc 1 325 13 view .LVU100
 336 00ac 2944     		add	r1, r1, r5
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 14


 337 00ae 58F8040B 		ldr	r0, [r8], #4
 338              	.LVL31:
 325:Core/Src/update_app.c ****             flash_data++;
 339              		.loc 1 325 13 view .LVU101
 340 00b2 FFF7FEFF 		bl	convert_uint32_t_to_uint8_t
 341              	.LVL32:
 326:Core/Src/update_app.c ****         }
 342              		.loc 1 326 13 is_stmt 1 view .LVU102
 323:Core/Src/update_app.c ****         {
 343              		.loc 1 323 54 discriminator 3 view .LVU103
 344 00b6 0134     		adds	r4, r4, #1
 345              	.LVL33:
 323:Core/Src/update_app.c ****         {
 346              		.loc 1 323 54 is_stmt 0 discriminator 3 view .LVU104
 347 00b8 E4B2     		uxtb	r4, r4
 348              	.LVL34:
 323:Core/Src/update_app.c ****         {
 349              		.loc 1 323 54 discriminator 3 view .LVU105
 350 00ba F2E7     		b	.L20
 351              	.L23:
 323:Core/Src/update_app.c ****         {
 352              		.loc 1 323 54 discriminator 3 view .LVU106
 353              	.LBE7:
 329:Core/Src/update_app.c ****         // 发送到bootloader
 354              		.loc 1 329 9 is_stmt 1 view .LVU107
 329:Core/Src/update_app.c ****         // 发送到bootloader
 355              		.loc 1 329 38 is_stmt 0 view .LVU108
 356 00bc 044B     		ldr	r3, .L24
 357 00be 4FF05C52 		mov	r2, #922746880
 358 00c2 5A61     		str	r2, [r3, #20]
 331:Core/Src/update_app.c ****     }
 359              		.loc 1 331 9 is_stmt 1 view .LVU109
 360 00c4 B11C     		adds	r1, r6, #2
 361 00c6 2846     		mov	r0, r5
 362 00c8 FFF7FEFF 		bl	can_service_response
 363              	.LVL35:
 364              	.LBE6:
 365              		.loc 1 365 1 is_stmt 0 view .LVU110
 366 00cc D2E7     		b	.L15
 367              	.L25:
 368 00ce 00BF     		.align	2
 369              	.L24:
 370 00d0 00000000 		.word	update_app_conf
 371              		.cfi_endproc
 372              	.LFE11:
 374              		.section	.text.download_finish_CRC_Validate,"ax",%progbits
 375              		.align	1
 376              		.global	download_finish_CRC_Validate
 377              		.syntax unified
 378              		.thumb
 379              		.thumb_func
 381              	download_finish_CRC_Validate:
 382              	.LFB14:
 366:Core/Src/update_app.c **** 
 367:Core/Src/update_app.c **** // 通知bootloader本次传包完成
 368:Core/Src/update_app.c **** 
 369:Core/Src/update_app.c **** void finish_download_app()
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 15


 370:Core/Src/update_app.c **** {
 371:Core/Src/update_app.c ****     update_app_conf.last_command = 0x37000000;
 372:Core/Src/update_app.c ****     uint8_t uds_data = 0x37;
 373:Core/Src/update_app.c ****     if (update_app_conf.command_result == false)
 374:Core/Src/update_app.c ****     {
 375:Core/Src/update_app.c ****         uart_printf(error_log, "37 service finish download fail ", NULL, 0);
 376:Core/Src/update_app.c ****         // retry
 377:Core/Src/update_app.c **** 
 378:Core/Src/update_app.c ****         pre_download_app();
 379:Core/Src/update_app.c ****         return;
 380:Core/Src/update_app.c ****     }
 381:Core/Src/update_app.c ****     update_app_conf.next_command = 0x31010202; // 下一步crc校验
 382:Core/Src/update_app.c ****     // 发送到bootloader
 383:Core/Src/update_app.c ****     can_service_response(&uds_data, 1);
 384:Core/Src/update_app.c **** }
 385:Core/Src/update_app.c **** 
 386:Core/Src/update_app.c **** // 通知app 进行crc校验
 387:Core/Src/update_app.c **** void download_app_crc_check()
 388:Core/Src/update_app.c **** {
 389:Core/Src/update_app.c ****     update_app_conf.last_command = 0x31010202;
 390:Core/Src/update_app.c ****     if (update_app_conf.command_result == false)
 391:Core/Src/update_app.c ****     {
 392:Core/Src/update_app.c ****         uart_printf(error_log, "31 service crc check fail ", NULL, 0);
 393:Core/Src/update_app.c ****         // retry
 394:Core/Src/update_app.c ****         pre_download_app();
 395:Core/Src/update_app.c ****         return;
 396:Core/Src/update_app.c ****     }
 397:Core/Src/update_app.c **** 
 398:Core/Src/update_app.c ****     uint8_t uds_data[8] = {0x31, 0x01, 0x02, 0x02};
 399:Core/Src/update_app.c ****     // 对数据进行CRC计算
 400:Core/Src/update_app.c ****     uint8_t CRC_package_length = update_app_conf.single_package_size / 4;
 401:Core/Src/update_app.c **** 
 402:Core/Src/update_app.c ****     uint32_t CRC_data[CRC_package_length];
 403:Core/Src/update_app.c ****     uint32_t *flash_data = (uint32_t *)update_app_conf.download_addr;
 404:Core/Src/update_app.c **** 
 405:Core/Src/update_app.c ****     for (uint16_t i = 0; i < CRC_package_length; i++)
 406:Core/Src/update_app.c ****     {
 407:Core/Src/update_app.c ****         CRC_data[i] = *flash_data;
 408:Core/Src/update_app.c ****         flash_data++;
 409:Core/Src/update_app.c ****     }
 410:Core/Src/update_app.c **** 
 411:Core/Src/update_app.c ****     // 进行CRC校验
 412:Core/Src/update_app.c ****     crc_reset();
 413:Core/Src/update_app.c ****     convert_uint32_t_to_uint8_t(crc_calculate(CRC_data, CRC_package_length), &uds_data[4]);
 414:Core/Src/update_app.c ****     update_app_conf.next_command = 0x31010203; // 安装
 415:Core/Src/update_app.c ****     // 发送到bootloader
 416:Core/Src/update_app.c ****     can_service_response(uds_data, 8);
 417:Core/Src/update_app.c **** }
 418:Core/Src/update_app.c **** 
 419:Core/Src/update_app.c **** void download_finish_CRC_Validate()
 420:Core/Src/update_app.c **** {
 383              		.loc 1 420 1 is_stmt 1 view -0
 384              		.cfi_startproc
 385              		@ args = 0, pretend = 0, frame = 16
 386              		@ frame_needed = 0, uses_anonymous_args = 0
 387 0000 70B5     		push	{r4, r5, r6, lr}
 388              		.cfi_def_cfa_offset 16
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 16


 389              		.cfi_offset 4, -16
 390              		.cfi_offset 5, -12
 391              		.cfi_offset 6, -8
 392              		.cfi_offset 14, -4
 393 0002 84B0     		sub	sp, sp, #16
 394              		.cfi_def_cfa_offset 32
 421:Core/Src/update_app.c ****     uint16_t flash_data_length = 0;
 395              		.loc 1 421 5 view .LVU112
 396              	.LVL36:
 422:Core/Src/update_app.c ****     uint32_t CRC_reult = 0;
 397              		.loc 1 422 5 view .LVU113
 423:Core/Src/update_app.c ****     uint8_t uds_data[16] = {0x31, 0x01, 0x02, 0x05};
 398              		.loc 1 423 5 view .LVU114
 399              		.loc 1 423 13 is_stmt 0 view .LVU115
 400 0004 134B     		ldr	r3, .L28
 401 0006 0093     		str	r3, [sp]
 402 0008 0023     		movs	r3, #0
 403 000a 0193     		str	r3, [sp, #4]
 404 000c 0293     		str	r3, [sp, #8]
 405 000e 0393     		str	r3, [sp, #12]
 424:Core/Src/update_app.c **** 
 425:Core/Src/update_app.c ****     uint32_t *temp = (uint32_t *)update_app_conf.erase_app_start_addr;
 406              		.loc 1 425 5 is_stmt 1 view .LVU116
 407              		.loc 1 425 49 is_stmt 0 view .LVU117
 408 0010 114C     		ldr	r4, .L28+4
 409 0012 2668     		ldr	r6, [r4]
 410              	.LVL37:
 426:Core/Src/update_app.c ****     update_app_conf.last_command = 0x31010205;
 411              		.loc 1 426 5 is_stmt 1 view .LVU118
 412              		.loc 1 426 34 is_stmt 0 view .LVU119
 413 0014 114B     		ldr	r3, .L28+8
 414 0016 2361     		str	r3, [r4, #16]
 427:Core/Src/update_app.c ****     flash_data_length = update_app_conf.erase_app_end_addr - update_app_conf.erase_app_start_addr;
 415              		.loc 1 427 5 is_stmt 1 view .LVU120
 416              		.loc 1 427 60 is_stmt 0 view .LVU121
 417 0018 2589     		ldrh	r5, [r4, #8]
 418 001a B3B2     		uxth	r3, r6
 419              		.loc 1 427 23 view .LVU122
 420 001c ED1A     		subs	r5, r5, r3
 421 001e ADB2     		uxth	r5, r5
 422              	.LVL38:
 428:Core/Src/update_app.c ****     crc_reset();
 423              		.loc 1 428 5 is_stmt 1 view .LVU123
 424 0020 FFF7FEFF 		bl	crc_reset
 425              	.LVL39:
 429:Core/Src/update_app.c ****     CRC_reult = crc_calculate(temp, flash_data_length / 4);
 426              		.loc 1 429 5 view .LVU124
 427              		.loc 1 429 17 is_stmt 0 view .LVU125
 428 0024 A908     		lsrs	r1, r5, #2
 429 0026 3046     		mov	r0, r6
 430 0028 FFF7FEFF 		bl	crc_calculate
 431              	.LVL40:
 430:Core/Src/update_app.c ****     convert_uint32_t_to_uint8_t(CRC_reult, &uds_data[4]);                            // crc结果
 432              		.loc 1 430 5 is_stmt 1 view .LVU126
 433 002c 01A9     		add	r1, sp, #4
 434 002e FFF7FEFF 		bl	convert_uint32_t_to_uint8_t
 435              	.LVL41:
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 17


 431:Core/Src/update_app.c ****     convert_uint32_t_to_uint8_t(update_app_conf.erase_app_start_addr, &uds_data[8]); // app的开
 436              		.loc 1 431 5 view .LVU127
 437 0032 02A9     		add	r1, sp, #8
 438 0034 2068     		ldr	r0, [r4]
 439 0036 FFF7FEFF 		bl	convert_uint32_t_to_uint8_t
 440              	.LVL42:
 432:Core/Src/update_app.c ****     convert_uint32_t_to_uint8_t(update_app_conf.erase_app_end_addr, &uds_data[12]);  // app的结
 441              		.loc 1 432 5 view .LVU128
 442 003a 03A9     		add	r1, sp, #12
 443 003c A068     		ldr	r0, [r4, #8]
 444 003e FFF7FEFF 		bl	convert_uint32_t_to_uint8_t
 445              	.LVL43:
 433:Core/Src/update_app.c ****     update_app_conf.next_command = 0x66666666;
 446              		.loc 1 433 5 view .LVU129
 447              		.loc 1 433 34 is_stmt 0 view .LVU130
 448 0042 4FF06633 		mov	r3, #1717986918
 449 0046 6361     		str	r3, [r4, #20]
 434:Core/Src/update_app.c ****     can_service_response(uds_data, 16);
 450              		.loc 1 434 5 is_stmt 1 view .LVU131
 451 0048 1021     		movs	r1, #16
 452 004a 6846     		mov	r0, sp
 453 004c FFF7FEFF 		bl	can_service_response
 454              	.LVL44:
 435:Core/Src/update_app.c **** }
 455              		.loc 1 435 1 is_stmt 0 view .LVU132
 456 0050 04B0     		add	sp, sp, #16
 457              		.cfi_def_cfa_offset 16
 458              		@ sp needed
 459 0052 70BD     		pop	{r4, r5, r6, pc}
 460              	.LVL45:
 461              	.L29:
 462              		.loc 1 435 1 view .LVU133
 463              		.align	2
 464              	.L28:
 465 0054 31010205 		.word	84017457
 466 0058 00000000 		.word	update_app_conf
 467 005c 05020131 		.word	822149637
 468              		.cfi_endproc
 469              	.LFE14:
 471              		.section	.rodata.pre_download_app.str1.4,"aMS",%progbits,1
 472              		.align	2
 473              	.LC2:
 474 0000 646F776E 		.ascii	"download app finish,start crc\015\012\000"
 474      6C6F6164 
 474      20617070 
 474      2066696E 
 474      6973682C 
 475              		.align	2
 476              	.LC3:
 477 0020 70726520 		.ascii	"pre download address \000"
 477      646F776E 
 477      6C6F6164 
 477      20616464 
 477      72657373 
 478 0036 0000     		.align	2
 479              	.LC4:
 480 0038 2D2D2D2D 		.ascii	"----------------------download rest size-----------"
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 18


 480      2D2D2D2D 
 480      2D2D2D2D 
 480      2D2D2D2D 
 480      2D2D2D2D 
 481 006b 2D2D2D2D 		.ascii	"--------------: \000"
 481      2D2D2D2D 
 481      2D2D2D2D 
 481      2D2D3A20 
 481      00
 482              		.section	.text.pre_download_app,"ax",%progbits
 483              		.align	1
 484              		.global	pre_download_app
 485              		.syntax unified
 486              		.thumb
 487              		.thumb_func
 489              	pre_download_app:
 490              	.LFB10:
 220:Core/Src/update_app.c **** 
 491              		.loc 1 220 1 is_stmt 1 view -0
 492              		.cfi_startproc
 493              		@ args = 0, pretend = 0, frame = 16
 494              		@ frame_needed = 0, uses_anonymous_args = 0
 495 0000 10B5     		push	{r4, lr}
 496              		.cfi_def_cfa_offset 8
 497              		.cfi_offset 4, -8
 498              		.cfi_offset 14, -4
 499 0002 84B0     		sub	sp, sp, #16
 500              		.cfi_def_cfa_offset 24
 222:Core/Src/update_app.c ****     uint8_t uds_data[8] = {0x34, 0x00, 0x14};    // memory size 1字节 memory address 4字节
 501              		.loc 1 222 5 view .LVU135
 222:Core/Src/update_app.c ****     uint8_t uds_data[8] = {0x34, 0x00, 0x14};    // memory size 1字节 memory address 4字节
 502              		.loc 1 222 34 is_stmt 0 view .LVU136
 503 0004 284B     		ldr	r3, .L39
 504 0006 4FF05052 		mov	r2, #872415232
 505 000a 1A61     		str	r2, [r3, #16]
 223:Core/Src/update_app.c ****     update_app_conf.package_count = 0;           // 包计数清零
 506              		.loc 1 223 5 is_stmt 1 view .LVU137
 223:Core/Src/update_app.c ****     update_app_conf.package_count = 0;           // 包计数清零
 507              		.loc 1 223 13 is_stmt 0 view .LVU138
 508 000c 274A     		ldr	r2, .L39+4
 509 000e 0292     		str	r2, [sp, #8]
 510 0010 0022     		movs	r2, #0
 511 0012 0392     		str	r2, [sp, #12]
 224:Core/Src/update_app.c ****     if (update_app_conf.command_result == false) // 上次执行fail
 512              		.loc 1 224 5 is_stmt 1 view .LVU139
 224:Core/Src/update_app.c ****     if (update_app_conf.command_result == false) // 上次执行fail
 513              		.loc 1 224 35 is_stmt 0 view .LVU140
 514 0014 1A77     		strb	r2, [r3, #28]
 225:Core/Src/update_app.c ****     {
 515              		.loc 1 225 5 is_stmt 1 view .LVU141
 225:Core/Src/update_app.c ****     {
 516              		.loc 1 225 24 is_stmt 0 view .LVU142
 517 0016 1B7E     		ldrb	r3, [r3, #24]	@ zero_extendqisi2
 225:Core/Src/update_app.c ****     {
 518              		.loc 1 225 8 view .LVU143
 519 0018 002B     		cmp	r3, #0
 520 001a 36D0     		beq	.L37
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 19


 232:Core/Src/update_app.c ****         {
 521              		.loc 1 232 9 is_stmt 1 view .LVU144
 232:Core/Src/update_app.c ****         {
 522              		.loc 1 232 28 is_stmt 0 view .LVU145
 523 001c 224B     		ldr	r3, .L39
 524 001e 9B7E     		ldrb	r3, [r3, #26]	@ zero_extendqisi2
 232:Core/Src/update_app.c ****         {
 525              		.loc 1 232 12 view .LVU146
 526 0020 012B     		cmp	r3, #1
 527 0022 38D0     		beq	.L38
 239:Core/Src/update_app.c ****         // 检查是不是下载到边界
 528              		.loc 1 239 9 is_stmt 1 view .LVU147
 239:Core/Src/update_app.c ****         // 检查是不是下载到边界
 529              		.loc 1 239 24 is_stmt 0 view .LVU148
 530 0024 204A     		ldr	r2, .L39
 531 0026 5068     		ldr	r0, [r2, #4]
 239:Core/Src/update_app.c ****         // 检查是不是下载到边界
 532              		.loc 1 239 57 view .LVU149
 533 0028 D37E     		ldrb	r3, [r2, #27]	@ zero_extendqisi2
 239:Core/Src/update_app.c ****         // 检查是不是下载到边界
 534              		.loc 1 239 39 view .LVU150
 535 002a 1844     		add	r0, r0, r3
 536 002c 5060     		str	r0, [r2, #4]
 241:Core/Src/update_app.c ****         {
 537              		.loc 1 241 9 is_stmt 1 view .LVU151
 241:Core/Src/update_app.c ****         {
 538              		.loc 1 241 43 is_stmt 0 view .LVU152
 539 002e 0344     		add	r3, r3, r0
 241:Core/Src/update_app.c ****         {
 540              		.loc 1 241 98 view .LVU153
 541 0030 9268     		ldr	r2, [r2, #8]
 241:Core/Src/update_app.c ****         {
 542              		.loc 1 241 12 view .LVU154
 543 0032 9342     		cmp	r3, r2
 544 0034 04D9     		bls	.L35
 244:Core/Src/update_app.c ****             // update_app_conf.download_addr = update_app_conf.erase_app_end_addr;
 545              		.loc 1 244 13 is_stmt 1 view .LVU155
 244:Core/Src/update_app.c ****             // update_app_conf.download_addr = update_app_conf.erase_app_end_addr;
 546              		.loc 1 244 86 is_stmt 0 view .LVU156
 547 0036 121A     		subs	r2, r2, r0
 244:Core/Src/update_app.c ****             // update_app_conf.download_addr = update_app_conf.erase_app_end_addr;
 548              		.loc 1 244 49 view .LVU157
 549 0038 1B4B     		ldr	r3, .L39
 550 003a DA76     		strb	r2, [r3, #27]
 246:Core/Src/update_app.c ****         }
 551              		.loc 1 246 13 is_stmt 1 view .LVU158
 246:Core/Src/update_app.c ****         }
 552              		.loc 1 246 45 is_stmt 0 view .LVU159
 553 003c 0122     		movs	r2, #1
 554 003e 9A76     		strb	r2, [r3, #26]
 555              	.L35:
 248:Core/Src/update_app.c ****     }
 556              		.loc 1 248 9 is_stmt 1 view .LVU160
 557 0040 03A9     		add	r1, sp, #12
 558 0042 FFF7FEFF 		bl	convert_uint32_t_to_uint8_t
 559              	.LVL46:
 560              	.L32:
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 20


 251:Core/Src/update_app.c ****     uart_printf(info_log, "pre download address ", &uds_data[3], 4);
 561              		.loc 1 251 5 view .LVU161
 251:Core/Src/update_app.c ****     uart_printf(info_log, "pre download address ", &uds_data[3], 4);
 562              		.loc 1 251 34 is_stmt 0 view .LVU162
 563 0046 184C     		ldr	r4, .L39
 564 0048 E37E     		ldrb	r3, [r4, #27]	@ zero_extendqisi2
 251:Core/Src/update_app.c ****     uart_printf(info_log, "pre download address ", &uds_data[3], 4);
 565              		.loc 1 251 17 view .LVU163
 566 004a 8DF80B30 		strb	r3, [sp, #11]
 252:Core/Src/update_app.c ****     // 36请求下载
 567              		.loc 1 252 5 is_stmt 1 view .LVU164
 568 004e 0423     		movs	r3, #4
 569 0050 0DF10B02 		add	r2, sp, #11
 570 0054 1649     		ldr	r1, .L39+8
 571 0056 0220     		movs	r0, #2
 572 0058 FFF7FEFF 		bl	uart_printf
 573              	.LVL47:
 254:Core/Src/update_app.c **** 
 574              		.loc 1 254 5 view .LVU165
 254:Core/Src/update_app.c **** 
 575              		.loc 1 254 34 is_stmt 0 view .LVU166
 576 005c 4FF05853 		mov	r3, #905969664
 577 0060 6361     		str	r3, [r4, #20]
 256:Core/Src/update_app.c **** 
 578              		.loc 1 256 5 is_stmt 1 view .LVU167
 256:Core/Src/update_app.c **** 
 579              		.loc 1 256 41 is_stmt 0 view .LVU168
 580 0062 A068     		ldr	r0, [r4, #8]
 256:Core/Src/update_app.c **** 
 581              		.loc 1 256 78 view .LVU169
 582 0064 6368     		ldr	r3, [r4, #4]
 583              	.LVL48:
 258:Core/Src/update_app.c ****     convert_uint32_t_to_uint8_t(rest_size, temp);
 584              		.loc 1 258 5 is_stmt 1 view .LVU170
 259:Core/Src/update_app.c ****     uart_printf(system_log, "----------------------download rest size-------------------------: ", 
 585              		.loc 1 259 5 view .LVU171
 586 0066 01A9     		add	r1, sp, #4
 587 0068 C01A     		subs	r0, r0, r3
 588              	.LVL49:
 259:Core/Src/update_app.c ****     uart_printf(system_log, "----------------------download rest size-------------------------: ", 
 589              		.loc 1 259 5 is_stmt 0 view .LVU172
 590 006a FFF7FEFF 		bl	convert_uint32_t_to_uint8_t
 591              	.LVL50:
 260:Core/Src/update_app.c ****     can_service_response(uds_data, 8);
 592              		.loc 1 260 5 is_stmt 1 view .LVU173
 593 006e 0423     		movs	r3, #4
 594 0070 0DEB0302 		add	r2, sp, r3
 595 0074 0F49     		ldr	r1, .L39+12
 596 0076 0820     		movs	r0, #8
 597 0078 FFF7FEFF 		bl	uart_printf
 598              	.LVL51:
 261:Core/Src/update_app.c **** }
 599              		.loc 1 261 5 view .LVU174
 600 007c 0821     		movs	r1, #8
 601 007e 0DEB0100 		add	r0, sp, r1
 602 0082 FFF7FEFF 		bl	can_service_response
 603              	.LVL52:
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 21


 604              	.L30:
 262:Core/Src/update_app.c **** 
 605              		.loc 1 262 1 is_stmt 0 view .LVU175
 606 0086 04B0     		add	sp, sp, #16
 607              		.cfi_remember_state
 608              		.cfi_def_cfa_offset 8
 609              		@ sp needed
 610 0088 10BD     		pop	{r4, pc}
 611              	.L37:
 612              		.cfi_restore_state
 228:Core/Src/update_app.c ****     }
 613              		.loc 1 228 9 is_stmt 1 view .LVU176
 614 008a 03A9     		add	r1, sp, #12
 615 008c 064B     		ldr	r3, .L39
 616 008e 5868     		ldr	r0, [r3, #4]
 617 0090 FFF7FEFF 		bl	convert_uint32_t_to_uint8_t
 618              	.LVL53:
 619 0094 D7E7     		b	.L32
 620              	.L38:
 235:Core/Src/update_app.c ****             download_finish_CRC_Validate();
 621              		.loc 1 235 13 view .LVU177
 622 0096 0023     		movs	r3, #0
 623 0098 1A46     		mov	r2, r3
 624 009a 0749     		ldr	r1, .L39+16
 625 009c 0220     		movs	r0, #2
 626 009e FFF7FEFF 		bl	uart_printf
 627              	.LVL54:
 236:Core/Src/update_app.c ****             return;
 628              		.loc 1 236 13 view .LVU178
 629 00a2 FFF7FEFF 		bl	download_finish_CRC_Validate
 630              	.LVL55:
 237:Core/Src/update_app.c ****         }
 631              		.loc 1 237 13 view .LVU179
 632 00a6 EEE7     		b	.L30
 633              	.L40:
 634              		.align	2
 635              	.L39:
 636 00a8 00000000 		.word	update_app_conf
 637 00ac 34001400 		.word	1310772
 638 00b0 20000000 		.word	.LC3
 639 00b4 38000000 		.word	.LC4
 640 00b8 00000000 		.word	.LC2
 641              		.cfi_endproc
 642              	.LFE10:
 644              		.section	.rodata.check_erase_app_result.str1.4,"aMS",%progbits,1
 645              		.align	2
 646              	.LC5:
 647 0000 65726173 		.ascii	"erase app success\015\012\000"
 647      65206170 
 647      70207375 
 647      63636573 
 647      730D0A00 
 648              		.align	2
 649              	.LC6:
 650 0014 65726173 		.ascii	"erase app fail\015\012\000"
 650      65206170 
 650      70206661 
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 22


 650      696C0D0A 
 650      00
 651              		.section	.text.check_erase_app_result,"ax",%progbits
 652              		.align	1
 653              		.global	check_erase_app_result
 654              		.syntax unified
 655              		.thumb
 656              		.thumb_func
 658              	check_erase_app_result:
 659              	.LFB9:
 188:Core/Src/update_app.c ****     uint8_t uds_data[12] = {0x31, 0x03, 0xff, 0x00};
 660              		.loc 1 188 1 view -0
 661              		.cfi_startproc
 662              		@ args = 0, pretend = 0, frame = 16
 663              		@ frame_needed = 0, uses_anonymous_args = 0
 664 0000 10B5     		push	{r4, lr}
 665              		.cfi_def_cfa_offset 8
 666              		.cfi_offset 4, -8
 667              		.cfi_offset 14, -4
 668 0002 84B0     		sub	sp, sp, #16
 669              		.cfi_def_cfa_offset 24
 189:Core/Src/update_app.c ****     // 下次执行检查擦写结果
 670              		.loc 1 189 5 view .LVU181
 189:Core/Src/update_app.c ****     // 下次执行检查擦写结果
 671              		.loc 1 189 13 is_stmt 0 view .LVU182
 672 0004 1B4B     		ldr	r3, .L49
 673 0006 0193     		str	r3, [sp, #4]
 674 0008 0023     		movs	r3, #0
 675 000a 0293     		str	r3, [sp, #8]
 676 000c 0393     		str	r3, [sp, #12]
 191:Core/Src/update_app.c ****     // 检查失败需要交给 check_erase_app_result处理
 677              		.loc 1 191 5 is_stmt 1 view .LVU183
 191:Core/Src/update_app.c ****     // 检查失败需要交给 check_erase_app_result处理
 678              		.loc 1 191 34 is_stmt 0 view .LVU184
 679 000e 1A4B     		ldr	r3, .L49+4
 680 0010 1A4A     		ldr	r2, .L49+8
 681 0012 5A61     		str	r2, [r3, #20]
 193:Core/Src/update_app.c **** 
 682              		.loc 1 193 5 is_stmt 1 view .LVU185
 193:Core/Src/update_app.c **** 
 683              		.loc 1 193 34 is_stmt 0 view .LVU186
 684 0014 1A61     		str	r2, [r3, #16]
 195:Core/Src/update_app.c ****     {
 685              		.loc 1 195 5 is_stmt 1 view .LVU187
 195:Core/Src/update_app.c ****     {
 686              		.loc 1 195 24 is_stmt 0 view .LVU188
 687 0016 5B7E     		ldrb	r3, [r3, #25]	@ zero_extendqisi2
 195:Core/Src/update_app.c ****     {
 688              		.loc 1 195 8 view .LVU189
 689 0018 022B     		cmp	r3, #2
 690 001a 03D0     		beq	.L46
 202:Core/Src/update_app.c ****     {
 691              		.loc 1 202 10 is_stmt 1 view .LVU190
 202:Core/Src/update_app.c ****     {
 692              		.loc 1 202 13 is_stmt 0 view .LVU191
 693 001c 012B     		cmp	r3, #1
 694 001e 11D0     		beq	.L47
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 23


 695              	.L41:
 217:Core/Src/update_app.c **** 
 696              		.loc 1 217 1 view .LVU192
 697 0020 04B0     		add	sp, sp, #16
 698              		.cfi_remember_state
 699              		.cfi_def_cfa_offset 8
 700              		@ sp needed
 701 0022 10BD     		pop	{r4, pc}
 702              	.L46:
 703              		.cfi_restore_state
 197:Core/Src/update_app.c ****         convert_uint32_t_to_uint8_t(update_app_conf.erase_app_end_addr, uds_data + 8);
 704              		.loc 1 197 9 is_stmt 1 view .LVU193
 705 0024 144C     		ldr	r4, .L49+4
 706 0026 02A9     		add	r1, sp, #8
 707 0028 2068     		ldr	r0, [r4]
 708 002a FFF7FEFF 		bl	convert_uint32_t_to_uint8_t
 709              	.LVL56:
 198:Core/Src/update_app.c ****         update_app_conf.erase_result = 1; // 等待bootloader 反馈
 710              		.loc 1 198 9 view .LVU194
 711 002e 03A9     		add	r1, sp, #12
 712 0030 A068     		ldr	r0, [r4, #8]
 713 0032 FFF7FEFF 		bl	convert_uint32_t_to_uint8_t
 714              	.LVL57:
 199:Core/Src/update_app.c ****         can_service_response(uds_data, 12);
 715              		.loc 1 199 9 view .LVU195
 199:Core/Src/update_app.c ****         can_service_response(uds_data, 12);
 716              		.loc 1 199 38 is_stmt 0 view .LVU196
 717 0036 0123     		movs	r3, #1
 718 0038 6376     		strb	r3, [r4, #25]
 200:Core/Src/update_app.c ****     }
 719              		.loc 1 200 9 is_stmt 1 view .LVU197
 720 003a 0C21     		movs	r1, #12
 721 003c 01A8     		add	r0, sp, #4
 722 003e FFF7FEFF 		bl	can_service_response
 723              	.LVL58:
 724 0042 EDE7     		b	.L41
 725              	.L47:
 204:Core/Src/update_app.c ****         {
 726              		.loc 1 204 9 view .LVU198
 204:Core/Src/update_app.c ****         {
 727              		.loc 1 204 28 is_stmt 0 view .LVU199
 728 0044 0C4B     		ldr	r3, .L49+4
 729 0046 1B7E     		ldrb	r3, [r3, #24]	@ zero_extendqisi2
 204:Core/Src/update_app.c ****         {
 730              		.loc 1 204 12 view .LVU200
 731 0048 012B     		cmp	r3, #1
 732 004a 06D0     		beq	.L48
 214:Core/Src/update_app.c ****         }
 733              		.loc 1 214 13 is_stmt 1 view .LVU201
 734 004c 0023     		movs	r3, #0
 735 004e 1A46     		mov	r2, r3
 736 0050 0B49     		ldr	r1, .L49+12
 737 0052 0220     		movs	r0, #2
 738 0054 FFF7FEFF 		bl	uart_printf
 739              	.LVL59:
 217:Core/Src/update_app.c **** 
 740              		.loc 1 217 1 is_stmt 0 view .LVU202
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 24


 741 0058 E2E7     		b	.L41
 742              	.L48:
 207:Core/Src/update_app.c ****             update_app_conf.command_result = false; // 34服务要用到
 743              		.loc 1 207 13 is_stmt 1 view .LVU203
 744 005a 0023     		movs	r3, #0
 745 005c 1A46     		mov	r2, r3
 746 005e 0949     		ldr	r1, .L49+16
 747 0060 0220     		movs	r0, #2
 748 0062 FFF7FEFF 		bl	uart_printf
 749              	.LVL60:
 208:Core/Src/update_app.c ****             pre_download_app();
 750              		.loc 1 208 13 view .LVU204
 208:Core/Src/update_app.c ****             pre_download_app();
 751              		.loc 1 208 44 is_stmt 0 view .LVU205
 752 0066 044B     		ldr	r3, .L49+4
 753 0068 0022     		movs	r2, #0
 754 006a 1A76     		strb	r2, [r3, #24]
 209:Core/Src/update_app.c ****         }
 755              		.loc 1 209 13 is_stmt 1 view .LVU206
 756 006c FFF7FEFF 		bl	pre_download_app
 757              	.LVL61:
 758 0070 D6E7     		b	.L41
 759              	.L50:
 760 0072 00BF     		.align	2
 761              	.L49:
 762 0074 3103FF00 		.word	16712497
 763 0078 00000000 		.word	update_app_conf
 764 007c 00FF0331 		.word	822345472
 765 0080 14000000 		.word	.LC6
 766 0084 00000000 		.word	.LC5
 767              		.cfi_endproc
 768              	.LFE9:
 770              		.section	.rodata.erase_app_start.str1.4,"aMS",%progbits,1
 771              		.align	2
 772              	.LC7:
 773 0000 65726173 		.ascii	"erase count \000"
 773      6520636F 
 773      756E7420 
 773      00
 774 000d 000000   		.align	2
 775              	.LC8:
 776 0010 65726173 		.ascii	"erase address \000"
 776      65206164 
 776      64726573 
 776      732000
 777              		.section	.text.erase_app_start,"ax",%progbits
 778              		.align	1
 779              		.global	erase_app_start
 780              		.syntax unified
 781              		.thumb
 782              		.thumb_func
 784              	erase_app_start:
 785              	.LFB8:
 143:Core/Src/update_app.c ****     uint8_t data_to_uint8_t[4] = {0};
 786              		.loc 1 143 1 view -0
 787              		.cfi_startproc
 788              		@ args = 0, pretend = 0, frame = 16
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 25


 789              		@ frame_needed = 0, uses_anonymous_args = 0
 790 0000 10B5     		push	{r4, lr}
 791              		.cfi_def_cfa_offset 8
 792              		.cfi_offset 4, -8
 793              		.cfi_offset 14, -4
 794 0002 84B0     		sub	sp, sp, #16
 795              		.cfi_def_cfa_offset 24
 144:Core/Src/update_app.c ****     uint8_t uds_data[8] = {0x31, 0x01, 0xff, 0x00};
 796              		.loc 1 144 5 view .LVU208
 144:Core/Src/update_app.c ****     uint8_t uds_data[8] = {0x31, 0x01, 0xff, 0x00};
 797              		.loc 1 144 13 is_stmt 0 view .LVU209
 798 0004 0023     		movs	r3, #0
 799 0006 0393     		str	r3, [sp, #12]
 145:Core/Src/update_app.c ****     uint32_t erase_address = 0;
 800              		.loc 1 145 5 is_stmt 1 view .LVU210
 145:Core/Src/update_app.c ****     uint32_t erase_address = 0;
 801              		.loc 1 145 13 is_stmt 0 view .LVU211
 802 0008 1A4A     		ldr	r2, .L58
 803 000a 0192     		str	r2, [sp, #4]
 804 000c 0293     		str	r3, [sp, #8]
 146:Core/Src/update_app.c **** 
 805              		.loc 1 146 5 is_stmt 1 view .LVU212
 806              	.LVL62:
 149:Core/Src/update_app.c **** 
 807              		.loc 1 149 5 view .LVU213
 149:Core/Src/update_app.c **** 
 808              		.loc 1 149 34 is_stmt 0 view .LVU214
 809 000e 1A4B     		ldr	r3, .L58+4
 810 0010 1A4A     		ldr	r2, .L58+8
 811 0012 1A61     		str	r2, [r3, #16]
 152:Core/Src/update_app.c **** 
 812              		.loc 1 152 5 is_stmt 1 view .LVU215
 152:Core/Src/update_app.c **** 
 813              		.loc 1 152 34 is_stmt 0 view .LVU216
 814 0014 5A61     		str	r2, [r3, #20]
 155:Core/Src/update_app.c ****     {
 815              		.loc 1 155 5 is_stmt 1 view .LVU217
 155:Core/Src/update_app.c ****     {
 816              		.loc 1 155 24 is_stmt 0 view .LVU218
 817 0016 1B7E     		ldrb	r3, [r3, #24]	@ zero_extendqisi2
 155:Core/Src/update_app.c ****     {
 818              		.loc 1 155 8 view .LVU219
 819 0018 E3B9     		cbnz	r3, .L52
 158:Core/Src/update_app.c **** 
 820              		.loc 1 158 9 is_stmt 1 view .LVU220
 158:Core/Src/update_app.c **** 
 821              		.loc 1 158 40 is_stmt 0 view .LVU221
 822 001a 174B     		ldr	r3, .L58+4
 823 001c 1C68     		ldr	r4, [r3]
 158:Core/Src/update_app.c **** 
 824              		.loc 1 158 79 view .LVU222
 825 001e 5B7B     		ldrb	r3, [r3, #13]	@ zero_extendqisi2
 158:Core/Src/update_app.c **** 
 826              		.loc 1 158 23 view .LVU223
 827 0020 04EB8324 		add	r4, r4, r3, lsl #10
 828              	.LVL63:
 829              	.L53:
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 26


 178:Core/Src/update_app.c ****     convert_uint32_t_to_uint8_t(erase_address, data_to_uint8_t);
 830              		.loc 1 178 5 is_stmt 1 view .LVU224
 831 0024 0123     		movs	r3, #1
 832 0026 164A     		ldr	r2, .L58+12
 833 0028 1649     		ldr	r1, .L58+16
 834 002a 0220     		movs	r0, #2
 835 002c FFF7FEFF 		bl	uart_printf
 836              	.LVL64:
 179:Core/Src/update_app.c ****     uart_printf(info_log, "erase address ", data_to_uint8_t, 4);
 837              		.loc 1 179 5 view .LVU225
 838 0030 03A9     		add	r1, sp, #12
 839 0032 2046     		mov	r0, r4
 840 0034 FFF7FEFF 		bl	convert_uint32_t_to_uint8_t
 841              	.LVL65:
 180:Core/Src/update_app.c ****     // 擦写的地址插入到uds命令
 842              		.loc 1 180 5 view .LVU226
 843 0038 0423     		movs	r3, #4
 844 003a 03AA     		add	r2, sp, #12
 845 003c 1249     		ldr	r1, .L58+20
 846 003e 0220     		movs	r0, #2
 847 0040 FFF7FEFF 		bl	uart_printf
 848              	.LVL66:
 182:Core/Src/update_app.c ****     // 调用tx 发送到bootloader
 849              		.loc 1 182 5 view .LVU227
 850 0044 039B     		ldr	r3, [sp, #12]
 851 0046 0293     		str	r3, [sp, #8]
 184:Core/Src/update_app.c **** }
 852              		.loc 1 184 5 view .LVU228
 853 0048 0821     		movs	r1, #8
 854 004a 01A8     		add	r0, sp, #4
 855 004c FFF7FEFF 		bl	can_service_response
 856              	.LVL67:
 857              	.L51:
 185:Core/Src/update_app.c **** 
 858              		.loc 1 185 1 is_stmt 0 view .LVU229
 859 0050 04B0     		add	sp, sp, #16
 860              		.cfi_remember_state
 861              		.cfi_def_cfa_offset 8
 862              		@ sp needed
 863 0052 10BD     		pop	{r4, pc}
 864              	.LVL68:
 865              	.L52:
 866              		.cfi_restore_state
 165:Core/Src/update_app.c ****         {
 867              		.loc 1 165 9 is_stmt 1 view .LVU230
 165:Core/Src/update_app.c ****         {
 868              		.loc 1 165 28 is_stmt 0 view .LVU231
 869 0054 084A     		ldr	r2, .L58+4
 870 0056 537B     		ldrb	r3, [r2, #13]	@ zero_extendqisi2
 165:Core/Src/update_app.c ****         {
 871              		.loc 1 165 63 view .LVU232
 872 0058 127B     		ldrb	r2, [r2, #12]	@ zero_extendqisi2
 165:Core/Src/update_app.c ****         {
 873              		.loc 1 165 12 view .LVU233
 874 005a 9342     		cmp	r3, r2
 875 005c 07D0     		beq	.L57
 173:Core/Src/update_app.c ****             // 本次擦写地址
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 27


 876              		.loc 1 173 13 is_stmt 1 view .LVU234
 173:Core/Src/update_app.c ****             // 本次擦写地址
 877              		.loc 1 173 44 is_stmt 0 view .LVU235
 878 005e 0133     		adds	r3, r3, #1
 879 0060 DBB2     		uxtb	r3, r3
 880 0062 054A     		ldr	r2, .L58+4
 881 0064 5373     		strb	r3, [r2, #13]
 175:Core/Src/update_app.c ****         }
 882              		.loc 1 175 13 is_stmt 1 view .LVU236
 175:Core/Src/update_app.c ****         }
 883              		.loc 1 175 44 is_stmt 0 view .LVU237
 884 0066 1468     		ldr	r4, [r2]
 175:Core/Src/update_app.c ****         }
 885              		.loc 1 175 27 view .LVU238
 886 0068 04EB8324 		add	r4, r4, r3, lsl #10
 887              	.LVL69:
 175:Core/Src/update_app.c ****         }
 888              		.loc 1 175 27 view .LVU239
 889 006c DAE7     		b	.L53
 890              	.LVL70:
 891              	.L57:
 167:Core/Src/update_app.c ****             return;
 892              		.loc 1 167 13 is_stmt 1 view .LVU240
 893 006e FFF7FEFF 		bl	check_erase_app_result
 894              	.LVL71:
 168:Core/Src/update_app.c ****         }
 895              		.loc 1 168 13 view .LVU241
 896 0072 EDE7     		b	.L51
 897              	.L59:
 898              		.align	2
 899              	.L58:
 900 0074 3101FF00 		.word	16711985
 901 0078 00000000 		.word	update_app_conf
 902 007c 00FF0131 		.word	822214400
 903 0080 0D000000 		.word	update_app_conf+13
 904 0084 00000000 		.word	.LC7
 905 0088 10000000 		.word	.LC8
 906              		.cfi_endproc
 907              	.LFE8:
 909              		.section	.rodata.finish_download_app.str1.4,"aMS",%progbits,1
 910              		.align	2
 911              	.LC9:
 912 0000 33372073 		.ascii	"37 service finish download fail \000"
 912      65727669 
 912      63652066 
 912      696E6973 
 912      6820646F 
 913              		.section	.text.finish_download_app,"ax",%progbits
 914              		.align	1
 915              		.global	finish_download_app
 916              		.syntax unified
 917              		.thumb
 918              		.thumb_func
 920              	finish_download_app:
 921              	.LFB12:
 370:Core/Src/update_app.c ****     update_app_conf.last_command = 0x37000000;
 922              		.loc 1 370 1 view -0
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 28


 923              		.cfi_startproc
 924              		@ args = 0, pretend = 0, frame = 8
 925              		@ frame_needed = 0, uses_anonymous_args = 0
 926 0000 00B5     		push	{lr}
 927              		.cfi_def_cfa_offset 4
 928              		.cfi_offset 14, -4
 929 0002 83B0     		sub	sp, sp, #12
 930              		.cfi_def_cfa_offset 16
 371:Core/Src/update_app.c ****     uint8_t uds_data = 0x37;
 931              		.loc 1 371 5 view .LVU243
 371:Core/Src/update_app.c ****     uint8_t uds_data = 0x37;
 932              		.loc 1 371 34 is_stmt 0 view .LVU244
 933 0004 0D4B     		ldr	r3, .L65
 934 0006 4FF05C52 		mov	r2, #922746880
 935 000a 1A61     		str	r2, [r3, #16]
 372:Core/Src/update_app.c ****     if (update_app_conf.command_result == false)
 936              		.loc 1 372 5 is_stmt 1 view .LVU245
 372:Core/Src/update_app.c ****     if (update_app_conf.command_result == false)
 937              		.loc 1 372 13 is_stmt 0 view .LVU246
 938 000c 3722     		movs	r2, #55
 939 000e 8DF80720 		strb	r2, [sp, #7]
 373:Core/Src/update_app.c ****     {
 940              		.loc 1 373 5 is_stmt 1 view .LVU247
 373:Core/Src/update_app.c ****     {
 941              		.loc 1 373 24 is_stmt 0 view .LVU248
 942 0012 1B7E     		ldrb	r3, [r3, #24]	@ zero_extendqisi2
 373:Core/Src/update_app.c ****     {
 943              		.loc 1 373 8 view .LVU249
 944 0014 53B1     		cbz	r3, .L64
 381:Core/Src/update_app.c ****     // 发送到bootloader
 945              		.loc 1 381 5 is_stmt 1 view .LVU250
 381:Core/Src/update_app.c ****     // 发送到bootloader
 946              		.loc 1 381 34 is_stmt 0 view .LVU251
 947 0016 094B     		ldr	r3, .L65
 948 0018 094A     		ldr	r2, .L65+4
 949 001a 5A61     		str	r2, [r3, #20]
 383:Core/Src/update_app.c **** }
 950              		.loc 1 383 5 is_stmt 1 view .LVU252
 951 001c 0121     		movs	r1, #1
 952 001e 0DF10700 		add	r0, sp, #7
 953 0022 FFF7FEFF 		bl	can_service_response
 954              	.LVL72:
 955              	.L60:
 384:Core/Src/update_app.c **** 
 956              		.loc 1 384 1 is_stmt 0 view .LVU253
 957 0026 03B0     		add	sp, sp, #12
 958              		.cfi_remember_state
 959              		.cfi_def_cfa_offset 4
 960              		@ sp needed
 961 0028 5DF804FB 		ldr	pc, [sp], #4
 962              	.L64:
 963              		.cfi_restore_state
 375:Core/Src/update_app.c ****         // retry
 964              		.loc 1 375 9 is_stmt 1 view .LVU254
 965 002c 1A46     		mov	r2, r3
 966 002e 0549     		ldr	r1, .L65+8
 967 0030 0420     		movs	r0, #4
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 29


 968 0032 FFF7FEFF 		bl	uart_printf
 969              	.LVL73:
 378:Core/Src/update_app.c ****         return;
 970              		.loc 1 378 9 view .LVU255
 971 0036 FFF7FEFF 		bl	pre_download_app
 972              	.LVL74:
 379:Core/Src/update_app.c ****     }
 973              		.loc 1 379 9 view .LVU256
 974 003a F4E7     		b	.L60
 975              	.L66:
 976              		.align	2
 977              	.L65:
 978 003c 00000000 		.word	update_app_conf
 979 0040 02020131 		.word	822149634
 980 0044 00000000 		.word	.LC9
 981              		.cfi_endproc
 982              	.LFE12:
 984              		.section	.rodata.start_install_app.str1.4,"aMS",%progbits,1
 985              		.align	2
 986              	.LC10:
 987 0000 626F6F74 		.ascii	"bootloader install app fail \000"
 987      6C6F6164 
 987      65722069 
 987      6E737461 
 987      6C6C2061 
 988              		.section	.text.start_install_app,"ax",%progbits
 989              		.align	1
 990              		.global	start_install_app
 991              		.syntax unified
 992              		.thumb
 993              		.thumb_func
 995              	start_install_app:
 996              	.LFB15:
 436:Core/Src/update_app.c **** 
 437:Core/Src/update_app.c **** // 通知bootloader安装本次包
 438:Core/Src/update_app.c **** void start_install_app()
 439:Core/Src/update_app.c **** {
 997              		.loc 1 439 1 view -0
 998              		.cfi_startproc
 999              		@ args = 0, pretend = 0, frame = 8
 1000              		@ frame_needed = 0, uses_anonymous_args = 0
 1001 0000 00B5     		push	{lr}
 1002              		.cfi_def_cfa_offset 4
 1003              		.cfi_offset 14, -4
 1004 0002 83B0     		sub	sp, sp, #12
 1005              		.cfi_def_cfa_offset 16
 440:Core/Src/update_app.c ****     // 34服务执行失败，交给34?
 441:Core/Src/update_app.c ****     if (update_app_conf.command_result == false)
 1006              		.loc 1 441 5 view .LVU258
 1007              		.loc 1 441 24 is_stmt 0 view .LVU259
 1008 0004 0D4B     		ldr	r3, .L72
 1009 0006 1B7E     		ldrb	r3, [r3, #24]	@ zero_extendqisi2
 1010              		.loc 1 441 8 view .LVU260
 1011 0008 83B1     		cbz	r3, .L71
 442:Core/Src/update_app.c ****     {
 443:Core/Src/update_app.c ****         uart_printf(error_log, "bootloader install app fail ", NULL, 0);
 444:Core/Src/update_app.c ****         pre_download_app();
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 30


 445:Core/Src/update_app.c ****         return;
 446:Core/Src/update_app.c ****     }
 447:Core/Src/update_app.c **** 
 448:Core/Src/update_app.c ****     update_app_conf.last_command = 0x31010203;
 1012              		.loc 1 448 5 is_stmt 1 view .LVU261
 1013              		.loc 1 448 34 is_stmt 0 view .LVU262
 1014 000a 0C4B     		ldr	r3, .L72
 1015 000c 0C4A     		ldr	r2, .L72+4
 1016 000e 1A61     		str	r2, [r3, #16]
 449:Core/Src/update_app.c ****     uint8_t uds_data[8] = {0x31, 0x01, 0x02, 0x03};
 1017              		.loc 1 449 5 is_stmt 1 view .LVU263
 1018              		.loc 1 449 13 is_stmt 0 view .LVU264
 1019 0010 0C4A     		ldr	r2, .L72+8
 1020 0012 0092     		str	r2, [sp]
 1021 0014 0022     		movs	r2, #0
 1022 0016 0192     		str	r2, [sp, #4]
 450:Core/Src/update_app.c ****     update_app_conf.next_command = 0x34000000;
 1023              		.loc 1 450 5 is_stmt 1 view .LVU265
 1024              		.loc 1 450 34 is_stmt 0 view .LVU266
 1025 0018 4FF05052 		mov	r2, #872415232
 1026 001c 5A61     		str	r2, [r3, #20]
 451:Core/Src/update_app.c ****     can_service_response(uds_data, 4);
 1027              		.loc 1 451 5 is_stmt 1 view .LVU267
 1028 001e 0421     		movs	r1, #4
 1029 0020 6846     		mov	r0, sp
 1030 0022 FFF7FEFF 		bl	can_service_response
 1031              	.LVL75:
 1032              	.L67:
 452:Core/Src/update_app.c **** }...
 1033              		.loc 1 452 1 is_stmt 0 view .LVU268
 1034 0026 03B0     		add	sp, sp, #12
 1035              		.cfi_remember_state
 1036              		.cfi_def_cfa_offset 4
 1037              		@ sp needed
 1038 0028 5DF804FB 		ldr	pc, [sp], #4
 1039              	.L71:
 1040              		.cfi_restore_state
 443:Core/Src/update_app.c ****         uart_printf(error_log, "bootloader install app fail ", NULL, 0);
 1041              		.loc 1 443 9 is_stmt 1 view .LVU269
 1042 002c 1A46     		mov	r2, r3
 1043 002e 0649     		ldr	r1, .L72+12
 1044 0030 0420     		movs	r0, #4
 1045 0032 FFF7FEFF 		bl	uart_printf
 1046              	.LVL76:
 444:Core/Src/update_app.c ****         pre_download_app();
 1047              		.loc 1 444 9 view .LVU270
 1048 0036 FFF7FEFF 		bl	pre_download_app
 1049              	.LVL77:
 445:Core/Src/update_app.c ****         return;
 1050              		.loc 1 445 9 view .LVU271
 1051 003a F4E7     		b	.L67
 1052              	.L73:
 1053              		.align	2
 1054              	.L72:
 1055 003c 00000000 		.word	update_app_conf
 1056 0040 03020131 		.word	822149635
 1057 0044 31010203 		.word	50463025
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 31


 1058 0048 00000000 		.word	.LC10
 1059              		.cfi_endproc
 1060              	.LFE15:
 1062              		.section	.rodata.download_app_crc_check.str1.4,"aMS",%progbits,1
 1063              		.align	2
 1064              	.LC11:
 1065 0000 33312073 		.ascii	"31 service crc check fail \000"
 1065      65727669 
 1065      63652063 
 1065      72632063 
 1065      6865636B 
 1066              		.section	.text.download_app_crc_check,"ax",%progbits
 1067              		.align	1
 1068              		.global	download_app_crc_check
 1069              		.syntax unified
 1070              		.thumb
 1071              		.thumb_func
 1073              	download_app_crc_check:
 1074              	.LFB13:
 388:Core/Src/update_app.c **** {
 1075              		.loc 1 388 1 view -0
 1076              		.cfi_startproc
 1077              		@ args = 0, pretend = 0, frame = 8
 1078              		@ frame_needed = 1, uses_anonymous_args = 0
 1079 0000 F0B5     		push	{r4, r5, r6, r7, lr}
 1080              		.cfi_def_cfa_offset 20
 1081              		.cfi_offset 4, -20
 1082              		.cfi_offset 5, -16
 1083              		.cfi_offset 6, -12
 1084              		.cfi_offset 7, -8
 1085              		.cfi_offset 14, -4
 1086 0002 83B0     		sub	sp, sp, #12
 1087              		.cfi_def_cfa_offset 32
 1088 0004 00AF     		add	r7, sp, #0
 1089              		.cfi_def_cfa_register 7
 388:Core/Src/update_app.c **** {
 1090              		.loc 1 388 1 is_stmt 0 view .LVU273
 1091 0006 6E46     		mov	r6, sp
 389:Core/Src/update_app.c ****     update_app_conf.last_command = 0x31010202;
 1092              		.loc 1 389 5 is_stmt 1 view .LVU274
 389:Core/Src/update_app.c ****     update_app_conf.last_command = 0x31010202;
 1093              		.loc 1 389 34 is_stmt 0 view .LVU275
 1094 0008 1D4B     		ldr	r3, .L81
 1095 000a 1E4A     		ldr	r2, .L81+4
 1096 000c 1A61     		str	r2, [r3, #16]
 390:Core/Src/update_app.c ****     if (update_app_conf.command_result == false)
 1097              		.loc 1 390 5 is_stmt 1 view .LVU276
 390:Core/Src/update_app.c ****     if (update_app_conf.command_result == false)
 1098              		.loc 1 390 24 is_stmt 0 view .LVU277
 1099 000e 1B7E     		ldrb	r3, [r3, #24]	@ zero_extendqisi2
 390:Core/Src/update_app.c ****     if (update_app_conf.command_result == false)
 1100              		.loc 1 390 8 view .LVU278
 1101 0010 83B1     		cbz	r3, .L80
 398:Core/Src/update_app.c ****     uint8_t uds_data[8] = {0x31, 0x01, 0x02, 0x02};
 1102              		.loc 1 398 5 is_stmt 1 view .LVU279
 398:Core/Src/update_app.c ****     uint8_t uds_data[8] = {0x31, 0x01, 0x02, 0x02};
 1103              		.loc 1 398 13 is_stmt 0 view .LVU280
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 32


 1104 0012 1D4B     		ldr	r3, .L81+8
 1105 0014 3B60     		str	r3, [r7]
 1106 0016 0023     		movs	r3, #0
 1107 0018 7B60     		str	r3, [r7, #4]
 400:Core/Src/update_app.c ****     uint8_t CRC_package_length = update_app_conf.single_package_size / 4;
 1108              		.loc 1 400 5 is_stmt 1 view .LVU281
 400:Core/Src/update_app.c ****     uint8_t CRC_package_length = update_app_conf.single_package_size / 4;
 1109              		.loc 1 400 49 is_stmt 0 view .LVU282
 1110 001a 1949     		ldr	r1, .L81
 1111 001c CA7E     		ldrb	r2, [r1, #27]	@ zero_extendqisi2
 400:Core/Src/update_app.c ****     uint8_t CRC_package_length = update_app_conf.single_package_size / 4;
 1112              		.loc 1 400 13 view .LVU283
 1113 001e 9408     		lsrs	r4, r2, #2
 1114              	.LVL78:
 402:Core/Src/update_app.c ****     uint32_t CRC_data[CRC_package_length];
 1115              		.loc 1 402 5 is_stmt 1 view .LVU284
 402:Core/Src/update_app.c ****     uint32_t CRC_data[CRC_package_length];
 1116              		.loc 1 402 14 is_stmt 0 view .LVU285
 1117 0020 02F0FC02 		and	r2, r2, #252
 1118 0024 0732     		adds	r2, r2, #7
 1119 0026 02F4FC72 		and	r2, r2, #504
 1120 002a ADEB020D 		sub	sp, sp, r2
 1121 002e 6D46     		mov	r5, sp
 1122              	.LVL79:
 403:Core/Src/update_app.c ****     uint32_t *flash_data = (uint32_t *)update_app_conf.download_addr;
 1123              		.loc 1 403 5 is_stmt 1 view .LVU286
 403:Core/Src/update_app.c ****     uint32_t *flash_data = (uint32_t *)update_app_conf.download_addr;
 1124              		.loc 1 403 55 is_stmt 0 view .LVU287
 1125 0030 4A68     		ldr	r2, [r1, #4]
 1126              	.LVL80:
 405:Core/Src/update_app.c ****     for (uint16_t i = 0; i < CRC_package_length; i++)
 1127              		.loc 1 405 5 is_stmt 1 view .LVU288
 1128              	.LBB8:
 405:Core/Src/update_app.c ****     for (uint16_t i = 0; i < CRC_package_length; i++)
 1129              		.loc 1 405 10 view .LVU289
 405:Core/Src/update_app.c ****     for (uint16_t i = 0; i < CRC_package_length; i++)
 1130              		.loc 1 405 5 is_stmt 0 view .LVU290
 1131 0032 0EE0     		b	.L77
 1132              	.LVL81:
 1133              	.L80:
 405:Core/Src/update_app.c ****     for (uint16_t i = 0; i < CRC_package_length; i++)
 1134              		.loc 1 405 5 view .LVU291
 1135              	.LBE8:
 392:Core/Src/update_app.c ****         uart_printf(error_log, "31 service crc check fail ", NULL, 0);
 1136              		.loc 1 392 9 is_stmt 1 view .LVU292
 1137 0034 1A46     		mov	r2, r3
 1138 0036 1549     		ldr	r1, .L81+12
 1139 0038 0420     		movs	r0, #4
 1140 003a FFF7FEFF 		bl	uart_printf
 1141              	.LVL82:
 394:Core/Src/update_app.c ****         pre_download_app();
 1142              		.loc 1 394 9 view .LVU293
 1143 003e FFF7FEFF 		bl	pre_download_app
 1144              	.LVL83:
 395:Core/Src/update_app.c ****         return;
 1145              		.loc 1 395 9 view .LVU294
 395:Core/Src/update_app.c ****         return;
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 33


 1146              		.loc 1 395 9 is_stmt 0 discriminator 1 view .LVU295
 1147 0042 B546     		mov	sp, r6
 1148 0044 18E0     		b	.L74
 1149              	.LVL84:
 1150              	.L78:
 1151              	.LBB9:
 407:Core/Src/update_app.c ****         CRC_data[i] = *flash_data;
 1152              		.loc 1 407 9 is_stmt 1 view .LVU296
 407:Core/Src/update_app.c ****         CRC_data[i] = *flash_data;
 1153              		.loc 1 407 23 is_stmt 0 view .LVU297
 1154 0046 52F8041B 		ldr	r1, [r2], #4
 1155              	.LVL85:
 407:Core/Src/update_app.c ****         CRC_data[i] = *flash_data;
 1156              		.loc 1 407 21 view .LVU298
 1157 004a 45F82310 		str	r1, [r5, r3, lsl #2]
 408:Core/Src/update_app.c ****         flash_data++;
 1158              		.loc 1 408 9 is_stmt 1 view .LVU299
 1159              	.LVL86:
 405:Core/Src/update_app.c ****     for (uint16_t i = 0; i < CRC_package_length; i++)
 1160              		.loc 1 405 51 discriminator 3 view .LVU300
 1161 004e 0133     		adds	r3, r3, #1
 1162              	.LVL87:
 405:Core/Src/update_app.c ****     for (uint16_t i = 0; i < CRC_package_length; i++)
 1163              		.loc 1 405 51 is_stmt 0 discriminator 3 view .LVU301
 1164 0050 9BB2     		uxth	r3, r3
 1165              	.LVL88:
 1166              	.L77:
 405:Core/Src/update_app.c ****     for (uint16_t i = 0; i < CRC_package_length; i++)
 1167              		.loc 1 405 28 is_stmt 1 discriminator 1 view .LVU302
 1168 0052 9C42     		cmp	r4, r3
 1169 0054 F7D8     		bhi	.L78
 405:Core/Src/update_app.c ****     for (uint16_t i = 0; i < CRC_package_length; i++)
 1170              		.loc 1 405 28 is_stmt 0 discriminator 1 view .LVU303
 1171              	.LBE9:
 412:Core/Src/update_app.c ****     crc_reset();
 1172              		.loc 1 412 5 is_stmt 1 view .LVU304
 1173 0056 FFF7FEFF 		bl	crc_reset
 1174              	.LVL89:
 413:Core/Src/update_app.c ****     convert_uint32_t_to_uint8_t(crc_calculate(CRC_data, CRC_package_length), &uds_data[4]);
 1175              		.loc 1 413 5 view .LVU305
 1176 005a 2146     		mov	r1, r4
 1177 005c 2846     		mov	r0, r5
 1178 005e FFF7FEFF 		bl	crc_calculate
 1179              	.LVL90:
 413:Core/Src/update_app.c ****     convert_uint32_t_to_uint8_t(crc_calculate(CRC_data, CRC_package_length), &uds_data[4]);
 1180              		.loc 1 413 5 is_stmt 0 discriminator 1 view .LVU306
 1181 0062 391D     		adds	r1, r7, #4
 1182 0064 FFF7FEFF 		bl	convert_uint32_t_to_uint8_t
 1183              	.LVL91:
 414:Core/Src/update_app.c ****     update_app_conf.next_command = 0x31010203; // 安装
 1184              		.loc 1 414 5 is_stmt 1 view .LVU307
 414:Core/Src/update_app.c ****     update_app_conf.next_command = 0x31010203; // 安装
 1185              		.loc 1 414 34 is_stmt 0 view .LVU308
 1186 0068 054B     		ldr	r3, .L81
 1187 006a 094A     		ldr	r2, .L81+16
 1188 006c 5A61     		str	r2, [r3, #20]
 416:Core/Src/update_app.c ****     can_service_response(uds_data, 8);
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 34


 1189              		.loc 1 416 5 is_stmt 1 view .LVU309
 1190 006e 0821     		movs	r1, #8
 1191 0070 3846     		mov	r0, r7
 1192 0072 FFF7FEFF 		bl	can_service_response
 1193              	.LVL92:
 1194 0076 B546     		mov	sp, r6
 1195              	.LVL93:
 1196              	.L74:
 417:Core/Src/update_app.c **** }
 1197              		.loc 1 417 1 is_stmt 0 view .LVU310
 1198 0078 0C37     		adds	r7, r7, #12
 1199              		.cfi_def_cfa_offset 20
 1200 007a BD46     		mov	sp, r7
 1201              		.cfi_def_cfa_register 13
 1202              		@ sp needed
 1203 007c F0BD     		pop	{r4, r5, r6, r7, pc}
 1204              	.L82:
 1205 007e 00BF     		.align	2
 1206              	.L81:
 1207 0080 00000000 		.word	update_app_conf
 1208 0084 02020131 		.word	822149634
 1209 0088 31010202 		.word	33685809
 1210 008c 00000000 		.word	.LC11
 1211 0090 03020131 		.word	822149635
 1212              		.cfi_endproc
 1213              	.LFE13:
 1215              		.section	.text.init_app_conf,"ax",%progbits
 1216              		.align	1
 1217              		.global	init_app_conf
 1218              		.syntax unified
 1219              		.thumb
 1220              		.thumb_func
 1222              	init_app_conf:
 1223              	.LFB3:
  25:Core/Src/update_app.c **** {
 1224              		.loc 1 25 1 is_stmt 1 view -0
 1225              		.cfi_startproc
 1226              		@ args = 0, pretend = 0, frame = 0
 1227              		@ frame_needed = 0, uses_anonymous_args = 0
 1228              		@ link register save eliminated.
  26:Core/Src/update_app.c ****     update_app_conf.erase_app_count = 0,
 1229              		.loc 1 26 5 view .LVU312
  26:Core/Src/update_app.c ****     update_app_conf.erase_app_count = 0,
 1230              		.loc 1 26 37 is_stmt 0 view .LVU313
 1231 0000 084B     		ldr	r3, .L84
 1232 0002 0022     		movs	r2, #0
 1233 0004 5A73     		strb	r2, [r3, #13]
  27:Core/Src/update_app.c ****     update_app_conf.erase_app_start_addr = 0x8002800UL,
 1234              		.loc 1 27 42 view .LVU314
 1235 0006 0849     		ldr	r1, .L84+4
 1236 0008 1960     		str	r1, [r3]
  28:Core/Src/update_app.c ****     update_app_conf.erase_app_end_addr = 0x00UL,
 1237              		.loc 1 28 40 view .LVU315
 1238 000a 9A60     		str	r2, [r3, #8]
  29:Core/Src/update_app.c ****     update_app_conf.download_addr = 0x8002800UL,
 1239              		.loc 1 29 35 view .LVU316
 1240 000c 5960     		str	r1, [r3, #4]
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 35


  30:Core/Src/update_app.c ****     update_app_conf.erase_app_toal_count = 0,
 1241              		.loc 1 30 42 view .LVU317
 1242 000e 1A73     		strb	r2, [r3, #12]
  31:Core/Src/update_app.c ****     update_app_conf.last_command = 0,
 1243              		.loc 1 31 34 view .LVU318
 1244 0010 1A61     		str	r2, [r3, #16]
  32:Core/Src/update_app.c ****     update_app_conf.next_command = 0,
 1245              		.loc 1 32 34 view .LVU319
 1246 0012 5A61     		str	r2, [r3, #20]
  33:Core/Src/update_app.c ****     update_app_conf.command_result = false,
 1247              		.loc 1 33 36 view .LVU320
 1248 0014 1A76     		strb	r2, [r3, #24]
  34:Core/Src/update_app.c ****     update_app_conf.single_package_size = 0X80,
 1249              		.loc 1 34 41 view .LVU321
 1250 0016 8021     		movs	r1, #128
 1251 0018 D976     		strb	r1, [r3, #27]
  35:Core/Src/update_app.c ****     update_app_conf.erase_result = 2; // waitchcek
 1252              		.loc 1 35 34 view .LVU322
 1253 001a 0221     		movs	r1, #2
 1254 001c 5976     		strb	r1, [r3, #25]
  36:Core/Src/update_app.c ****     update_app_conf.download_finish = false;
 1255              		.loc 1 36 5 is_stmt 1 view .LVU323
  36:Core/Src/update_app.c ****     update_app_conf.download_finish = false;
 1256              		.loc 1 36 37 is_stmt 0 view .LVU324
 1257 001e 9A76     		strb	r2, [r3, #26]
  37:Core/Src/update_app.c **** }
 1258              		.loc 1 37 1 view .LVU325
 1259 0020 7047     		bx	lr
 1260              	.L85:
 1261 0022 00BF     		.align	2
 1262              	.L84:
 1263 0024 00000000 		.word	update_app_conf
 1264 0028 00280008 		.word	134227968
 1265              		.cfi_endproc
 1266              	.LFE3:
 1268              		.section	.rodata.update_app_entry.str1.4,"aMS",%progbits,1
 1269              		.align	2
 1270              	.LC12:
 1271 0000 75706461 		.ascii	"update_app_entry \000"
 1271      74655F61 
 1271      70705F65 
 1271      6E747279 
 1271      2000
 1272 0012 0000     		.align	2
 1273              	.LC13:
 1274 0014 72657472 		.ascii	"retry\000"
 1274      7900
 1275 001a 0000     		.align	2
 1276              	.LC14:
 1277 001c 72657472 		.ascii	"retry  failed ......\015\012\000"
 1277      79202066 
 1277      61696C65 
 1277      64202E2E 
 1277      2E2E2E2E 
 1278              		.section	.text.update_app_entry,"ax",%progbits
 1279              		.align	1
 1280              		.global	update_app_entry
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 36


 1281              		.syntax unified
 1282              		.thumb
 1283              		.thumb_func
 1285              	update_app_entry:
 1286              	.LVL94:
 1287              	.LFB6:
  70:Core/Src/update_app.c **** {
 1288              		.loc 1 70 1 is_stmt 1 view -0
 1289              		.cfi_startproc
 1290              		@ args = 0, pretend = 0, frame = 0
 1291              		@ frame_needed = 0, uses_anonymous_args = 0
  70:Core/Src/update_app.c **** {
 1292              		.loc 1 70 1 is_stmt 0 view .LVU327
 1293 0000 10B5     		push	{r4, lr}
 1294              		.cfi_def_cfa_offset 8
 1295              		.cfi_offset 4, -8
 1296              		.cfi_offset 14, -4
 1297 0002 0446     		mov	r4, r0
  72:Core/Src/update_app.c ****     for (int i = 0; i < 72000; i++)
 1298              		.loc 1 72 5 is_stmt 1 view .LVU328
 1299              	.LBB10:
  72:Core/Src/update_app.c ****     for (int i = 0; i < 72000; i++)
 1300              		.loc 1 72 10 view .LVU329
 1301              	.LVL95:
  72:Core/Src/update_app.c ****     for (int i = 0; i < 72000; i++)
 1302              		.loc 1 72 14 is_stmt 0 view .LVU330
 1303 0004 0022     		movs	r2, #0
  72:Core/Src/update_app.c ****     for (int i = 0; i < 72000; i++)
 1304              		.loc 1 72 5 view .LVU331
 1305 0006 00E0     		b	.L87
 1306              	.LVL96:
 1307              	.L88:
  74:Core/Src/update_app.c ****     }
 1308              		.loc 1 74 5 is_stmt 1 view .LVU332
  72:Core/Src/update_app.c ****     for (int i = 0; i < 72000; i++)
 1309              		.loc 1 72 33 discriminator 3 view .LVU333
 1310 0008 0132     		adds	r2, r2, #1
 1311              	.LVL97:
 1312              	.L87:
  72:Core/Src/update_app.c ****     for (int i = 0; i < 72000; i++)
 1313              		.loc 1 72 23 discriminator 1 view .LVU334
 1314 000a 214B     		ldr	r3, .L97
 1315 000c 9A42     		cmp	r2, r3
 1316 000e FBDD     		ble	.L88
 1317              	.LBE10:
  75:Core/Src/update_app.c ****     uart_printf(system_log, "update_app_entry ", data, dataLen);
 1318              		.loc 1 75 5 view .LVU335
 1319 0010 CBB2     		uxtb	r3, r1
 1320 0012 2246     		mov	r2, r4
 1321              	.LVL98:
  75:Core/Src/update_app.c ****     uart_printf(system_log, "update_app_entry ", data, dataLen);
 1322              		.loc 1 75 5 is_stmt 0 view .LVU336
 1323 0014 1F49     		ldr	r1, .L97+4
 1324              	.LVL99:
  75:Core/Src/update_app.c ****     uart_printf(system_log, "update_app_entry ", data, dataLen);
 1325              		.loc 1 75 5 view .LVU337
 1326 0016 0820     		movs	r0, #8
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 37


 1327              	.LVL100:
  75:Core/Src/update_app.c ****     uart_printf(system_log, "update_app_entry ", data, dataLen);
 1328              		.loc 1 75 5 view .LVU338
 1329 0018 FFF7FEFF 		bl	uart_printf
 1330              	.LVL101:
  77:Core/Src/update_app.c ****     uint8_t temp_data = (update_app_conf.last_command >> 24);
 1331              		.loc 1 77 5 is_stmt 1 view .LVU339
  77:Core/Src/update_app.c ****     uint8_t temp_data = (update_app_conf.last_command >> 24);
 1332              		.loc 1 77 55 is_stmt 0 view .LVU340
 1333 001c 1E4B     		ldr	r3, .L97+8
 1334 001e DB7C     		ldrb	r3, [r3, #19]	@ zero_extendqisi2
 1335              	.LVL102:
  80:Core/Src/update_app.c ****     if (data[0] != (temp_data + 0x40))
 1336              		.loc 1 80 5 is_stmt 1 view .LVU341
  80:Core/Src/update_app.c ****     if (data[0] != (temp_data + 0x40))
 1337              		.loc 1 80 13 is_stmt 0 view .LVU342
 1338 0020 2278     		ldrb	r2, [r4]	@ zero_extendqisi2
  80:Core/Src/update_app.c ****     if (data[0] != (temp_data + 0x40))
 1339              		.loc 1 80 31 view .LVU343
 1340 0022 4033     		adds	r3, r3, #64
 1341              	.LVL103:
  80:Core/Src/update_app.c ****     if (data[0] != (temp_data + 0x40))
 1342              		.loc 1 80 8 view .LVU344
 1343 0024 9A42     		cmp	r2, r3
 1344 0026 25D0     		beq	.L89
  83:Core/Src/update_app.c ****         if (data[0] == 0x30 || data[0] == 0x3e || ((data[0] == 0x7f) && (data[2] == 0x78)))
 1345              		.loc 1 83 9 is_stmt 1 view .LVU345
  83:Core/Src/update_app.c ****         if (data[0] == 0x30 || data[0] == 0x3e || ((data[0] == 0x7f) && (data[2] == 0x78)))
 1346              		.loc 1 83 12 is_stmt 0 view .LVU346
 1347 0028 302A     		cmp	r2, #48
 1348 002a 2BD0     		beq	.L86
  83:Core/Src/update_app.c ****         if (data[0] == 0x30 || data[0] == 0x3e || ((data[0] == 0x7f) && (data[2] == 0x78)))
 1349              		.loc 1 83 29 discriminator 1 view .LVU347
 1350 002c 3E2A     		cmp	r2, #62
 1351 002e 29D0     		beq	.L86
  83:Core/Src/update_app.c ****         if (data[0] == 0x30 || data[0] == 0x3e || ((data[0] == 0x7f) && (data[2] == 0x78)))
 1352              		.loc 1 83 48 discriminator 2 view .LVU348
 1353 0030 7F2A     		cmp	r2, #127
 1354 0032 02D1     		bne	.L91
  83:Core/Src/update_app.c ****         if (data[0] == 0x30 || data[0] == 0x3e || ((data[0] == 0x7f) && (data[2] == 0x78)))
 1355              		.loc 1 83 78 discriminator 3 view .LVU349
 1356 0034 A378     		ldrb	r3, [r4, #2]	@ zero_extendqisi2
 1357              	.LVL104:
  83:Core/Src/update_app.c ****         if (data[0] == 0x30 || data[0] == 0x3e || ((data[0] == 0x7f) && (data[2] == 0x78)))
 1358              		.loc 1 83 70 discriminator 3 view .LVU350
 1359 0036 782B     		cmp	r3, #120
 1360 0038 24D0     		beq	.L86
 1361              	.L91:
  89:Core/Src/update_app.c ****             uart_printf(error_log, "retry", &update_app_conf.retry_count, 1);
 1362              		.loc 1 89 13 is_stmt 1 view .LVU351
 1363 003a 184C     		ldr	r4, .L97+12
 1364              	.LVL105:
  89:Core/Src/update_app.c ****             uart_printf(error_log, "retry", &update_app_conf.retry_count, 1);
 1365              		.loc 1 89 13 is_stmt 0 view .LVU352
 1366 003c 0123     		movs	r3, #1
 1367 003e 2246     		mov	r2, r4
 1368 0040 1749     		ldr	r1, .L97+16
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 38


 1369 0042 0420     		movs	r0, #4
 1370 0044 FFF7FEFF 		bl	uart_printf
 1371              	.LVL106:
  90:Core/Src/update_app.c ****             update_app_conf.retry_count++;
 1372              		.loc 1 90 13 is_stmt 1 view .LVU353
  90:Core/Src/update_app.c ****             update_app_conf.retry_count++;
 1373              		.loc 1 90 28 is_stmt 0 view .LVU354
 1374 0048 2246     		mov	r2, r4
 1375 004a 12F81E39 		ldrb	r3, [r2], #-30	@ zero_extendqisi2
  90:Core/Src/update_app.c ****             update_app_conf.retry_count++;
 1376              		.loc 1 90 40 view .LVU355
 1377 004e 0133     		adds	r3, r3, #1
 1378 0050 DBB2     		uxtb	r3, r3
 1379 0052 9377     		strb	r3, [r2, #30]
  91:Core/Src/update_app.c ****             if (update_app_conf.retry_count >= 3)
 1380              		.loc 1 91 13 is_stmt 1 view .LVU356
  91:Core/Src/update_app.c ****             if (update_app_conf.retry_count >= 3)
 1381              		.loc 1 91 16 is_stmt 0 view .LVU357
 1382 0054 022B     		cmp	r3, #2
 1383 0056 06D8     		bhi	.L95
  97:Core/Src/update_app.c ****             update_app_conf.command_result = false;
 1384              		.loc 1 97 13 is_stmt 1 view .LVU358
  97:Core/Src/update_app.c ****             update_app_conf.command_result = false;
 1385              		.loc 1 97 44 is_stmt 0 view .LVU359
 1386 0058 0F4B     		ldr	r3, .L97+8
 1387 005a 0022     		movs	r2, #0
 1388 005c 1A76     		strb	r2, [r3, #24]
  98:Core/Src/update_app.c ****             execute_update_APP_fucntion(update_app_conf.last_command);
 1389              		.loc 1 98 13 is_stmt 1 view .LVU360
 1390 005e 1869     		ldr	r0, [r3, #16]
 1391 0060 FFF7FEFF 		bl	execute_update_APP_fucntion
 1392              	.LVL107:
 1393 0064 0EE0     		b	.L86
 1394              	.L95:
  94:Core/Src/update_app.c ****                 uart_printf(error_log, "retry  failed ......\r\n", NULL, 0);
 1395              		.loc 1 94 17 view .LVU361
 1396 0066 0023     		movs	r3, #0
 1397 0068 1A46     		mov	r2, r3
 1398 006a 0E49     		ldr	r1, .L97+20
 1399 006c 0420     		movs	r0, #4
 1400 006e FFF7FEFF 		bl	uart_printf
 1401              	.LVL108:
  95:Core/Src/update_app.c ****                 return;
 1402              		.loc 1 95 17 view .LVU362
 1403 0072 07E0     		b	.L86
 1404              	.LVL109:
 1405              	.L89:
 103:Core/Src/update_app.c ****         if (data[0] == 0x74)
 1406              		.loc 1 103 9 view .LVU363
 103:Core/Src/update_app.c ****         if (data[0] == 0x74)
 1407              		.loc 1 103 12 is_stmt 0 view .LVU364
 1408 0074 742A     		cmp	r2, #116
 1409 0076 06D0     		beq	.L96
 1410              	.LVL110:
 1411              	.L93:
 107:Core/Src/update_app.c ****         execute_update_APP_fucntion(update_app_conf.next_command);
 1412              		.loc 1 107 9 is_stmt 1 view .LVU365
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 39


 1413 0078 074C     		ldr	r4, .L97+8
 1414              	.LVL111:
 107:Core/Src/update_app.c ****         execute_update_APP_fucntion(update_app_conf.next_command);
 1415              		.loc 1 107 9 is_stmt 0 view .LVU366
 1416 007a 6069     		ldr	r0, [r4, #20]
 1417 007c FFF7FEFF 		bl	execute_update_APP_fucntion
 1418              	.LVL112:
 108:Core/Src/update_app.c ****         update_app_conf.command_result = true;
 1419              		.loc 1 108 9 is_stmt 1 view .LVU367
 108:Core/Src/update_app.c ****         update_app_conf.command_result = true;
 1420              		.loc 1 108 40 is_stmt 0 view .LVU368
 1421 0080 0123     		movs	r3, #1
 1422 0082 2376     		strb	r3, [r4, #24]
 1423              	.L86:
 110:Core/Src/update_app.c **** }
 1424              		.loc 1 110 1 view .LVU369
 1425 0084 10BD     		pop	{r4, pc}
 1426              	.LVL113:
 1427              	.L96:
 105:Core/Src/update_app.c ****             update_app_conf.response_package_size = data[2];
 1428              		.loc 1 105 13 is_stmt 1 view .LVU370
 105:Core/Src/update_app.c ****             update_app_conf.response_package_size = data[2];
 1429              		.loc 1 105 51 is_stmt 0 view .LVU371
 1430 0086 A278     		ldrb	r2, [r4, #2]	@ zero_extendqisi2
 1431 0088 034B     		ldr	r3, .L97+8
 1432              	.LVL114:
 105:Core/Src/update_app.c ****             update_app_conf.response_package_size = data[2];
 1433              		.loc 1 105 51 view .LVU372
 1434 008a 5A77     		strb	r2, [r3, #29]
 1435 008c F4E7     		b	.L93
 1436              	.L98:
 1437 008e 00BF     		.align	2
 1438              	.L97:
 1439 0090 3F190100 		.word	71999
 1440 0094 00000000 		.word	.LC12
 1441 0098 00000000 		.word	update_app_conf
 1442 009c 1E000000 		.word	update_app_conf+30
 1443 00a0 14000000 		.word	.LC13
 1444 00a4 1C000000 		.word	.LC14
 1445              		.cfi_endproc
 1446              	.LFE6:
 1448              		.section	.rodata.calcutate_app_size.str1.4,"aMS",%progbits,1
 1449              		.align	2
 1450              	.LC15:
 1451 0000 74686520 		.ascii	"the app size is: \000"
 1451      61707020 
 1451      73697A65 
 1451      2069733A 
 1451      2000
 1452 0012 0000     		.align	2
 1453              	.LC16:
 1454 0014 626F6F74 		.ascii	"bootloader need erase block count is: \000"
 1454      6C6F6164 
 1454      6572206E 
 1454      65656420 
 1454      65726173 
 1455              		.section	.text.calcutate_app_size,"ax",%progbits
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 40


 1456              		.align	1
 1457              		.global	calcutate_app_size
 1458              		.syntax unified
 1459              		.thumb
 1460              		.thumb_func
 1462              	calcutate_app_size:
 1463              	.LFB7:
 113:Core/Src/update_app.c **** {
 1464              		.loc 1 113 1 is_stmt 1 view -0
 1465              		.cfi_startproc
 1466              		@ args = 0, pretend = 0, frame = 8
 1467              		@ frame_needed = 0, uses_anonymous_args = 0
 1468 0000 10B5     		push	{r4, lr}
 1469              		.cfi_def_cfa_offset 8
 1470              		.cfi_offset 4, -8
 1471              		.cfi_offset 14, -4
 1472 0002 82B0     		sub	sp, sp, #8
 1473              		.cfi_def_cfa_offset 16
 114:Core/Src/update_app.c ****     uint32_t *APP_start_address = (uint32_t *)0x8002800UL;
 1474              		.loc 1 114 5 view .LVU374
 1475              	.LVL115:
 115:Core/Src/update_app.c ****     uint32_t APPSize = 0;
 1476              		.loc 1 115 5 view .LVU375
 117:Core/Src/update_app.c ****     uint8_t date_to_uint8_t[4] = {0};
 1477              		.loc 1 117 5 view .LVU376
 117:Core/Src/update_app.c ****     uint8_t date_to_uint8_t[4] = {0};
 1478              		.loc 1 117 13 is_stmt 0 view .LVU377
 1479 0004 0024     		movs	r4, #0
 1480 0006 0194     		str	r4, [sp, #4]
 119:Core/Src/update_app.c ****     while (*APP_start_address != 0xFFFFFFFF)
 1481              		.loc 1 119 5 is_stmt 1 view .LVU378
 114:Core/Src/update_app.c ****     uint32_t *APP_start_address = (uint32_t *)0x8002800UL;
 1482              		.loc 1 114 15 is_stmt 0 view .LVU379
 1483 0008 184B     		ldr	r3, .L104
 119:Core/Src/update_app.c ****     while (*APP_start_address != 0xFFFFFFFF)
 1484              		.loc 1 119 11 view .LVU380
 1485 000a 01E0     		b	.L100
 1486              	.LVL116:
 1487              	.L101:
 121:Core/Src/update_app.c ****         APPSize += 4;
 1488              		.loc 1 121 9 is_stmt 1 view .LVU381
 121:Core/Src/update_app.c ****         APPSize += 4;
 1489              		.loc 1 121 17 is_stmt 0 view .LVU382
 1490 000c 0434     		adds	r4, r4, #4
 1491              	.LVL117:
 122:Core/Src/update_app.c ****         APP_start_address++;
 1492              		.loc 1 122 9 is_stmt 1 view .LVU383
 122:Core/Src/update_app.c ****         APP_start_address++;
 1493              		.loc 1 122 26 is_stmt 0 view .LVU384
 1494 000e 0433     		adds	r3, r3, #4
 1495              	.LVL118:
 1496              	.L100:
 119:Core/Src/update_app.c ****     while (*APP_start_address != 0xFFFFFFFF)
 1497              		.loc 1 119 31 is_stmt 1 view .LVU385
 119:Core/Src/update_app.c ****     while (*APP_start_address != 0xFFFFFFFF)
 1498              		.loc 1 119 12 is_stmt 0 view .LVU386
 1499 0010 1A68     		ldr	r2, [r3]
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 41


 119:Core/Src/update_app.c ****     while (*APP_start_address != 0xFFFFFFFF)
 1500              		.loc 1 119 31 view .LVU387
 1501 0012 B2F1FF3F 		cmp	r2, #-1
 1502 0016 F9D1     		bne	.L101
 125:Core/Src/update_app.c ****     convert_uint32_t_to_uint8_t(APPSize, date_to_uint8_t);
 1503              		.loc 1 125 5 is_stmt 1 view .LVU388
 1504 0018 01A9     		add	r1, sp, #4
 1505 001a 2046     		mov	r0, r4
 1506 001c FFF7FEFF 		bl	convert_uint32_t_to_uint8_t
 1507              	.LVL119:
 126:Core/Src/update_app.c ****     uart_printf(info_log, "the app size is: ", date_to_uint8_t, 4);
 1508              		.loc 1 126 5 view .LVU389
 1509 0020 0423     		movs	r3, #4
 1510 0022 0DEB0302 		add	r2, sp, r3
 1511 0026 1249     		ldr	r1, .L104+4
 1512 0028 0220     		movs	r0, #2
 1513 002a FFF7FEFF 		bl	uart_printf
 1514              	.LVL120:
 127:Core/Src/update_app.c ****     update_app_conf.erase_app_end_addr = 0x8002800UL + APPSize;
 1515              		.loc 1 127 5 view .LVU390
 127:Core/Src/update_app.c ****     update_app_conf.erase_app_end_addr = 0x8002800UL + APPSize;
 1516              		.loc 1 127 54 is_stmt 0 view .LVU391
 1517 002e 04F10063 		add	r3, r4, #134217728
 1518 0032 03F52053 		add	r3, r3, #10240
 127:Core/Src/update_app.c ****     update_app_conf.erase_app_end_addr = 0x8002800UL + APPSize;
 1519              		.loc 1 127 40 view .LVU392
 1520 0036 0F4A     		ldr	r2, .L104+8
 1521 0038 9360     		str	r3, [r2, #8]
 129:Core/Src/update_app.c ****     uint8_t bootloader_erase_block_count = APPSize / 1024;
 1522              		.loc 1 129 5 is_stmt 1 view .LVU393
 129:Core/Src/update_app.c ****     uint8_t bootloader_erase_block_count = APPSize / 1024;
 1523              		.loc 1 129 13 is_stmt 0 view .LVU394
 1524 003a C4F38723 		ubfx	r3, r4, #10, #8
 1525 003e 8DF80330 		strb	r3, [sp, #3]
 131:Core/Src/update_app.c ****     if (APPSize % 1024 != 0)
 1526              		.loc 1 131 5 is_stmt 1 view .LVU395
 131:Core/Src/update_app.c ****     if (APPSize % 1024 != 0)
 1527              		.loc 1 131 17 is_stmt 0 view .LVU396
 1528 0042 C4F30904 		ubfx	r4, r4, #0, #10
 1529              	.LVL121:
 131:Core/Src/update_app.c ****     if (APPSize % 1024 != 0)
 1530              		.loc 1 131 8 view .LVU397
 1531 0046 14B1     		cbz	r4, .L102
 133:Core/Src/update_app.c ****         bootloader_erase_block_count += 1;
 1532              		.loc 1 133 9 is_stmt 1 view .LVU398
 133:Core/Src/update_app.c ****         bootloader_erase_block_count += 1;
 1533              		.loc 1 133 38 is_stmt 0 view .LVU399
 1534 0048 0133     		adds	r3, r3, #1
 1535 004a 8DF80330 		strb	r3, [sp, #3]
 1536              	.L102:
 135:Core/Src/update_app.c ****     uart_printf(info_log, "bootloader need erase block count is: ", &bootloader_erase_block_count, 
 1537              		.loc 1 135 5 is_stmt 1 view .LVU400
 1538 004e 0123     		movs	r3, #1
 1539 0050 0DF10302 		add	r2, sp, #3
 1540              	.LVL122:
 135:Core/Src/update_app.c ****     uart_printf(info_log, "bootloader need erase block count is: ", &bootloader_erase_block_count, 
 1541              		.loc 1 135 5 is_stmt 0 view .LVU401
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 42


 1542 0054 0849     		ldr	r1, .L104+12
 1543 0056 0220     		movs	r0, #2
 1544 0058 FFF7FEFF 		bl	uart_printf
 1545              	.LVL123:
 137:Core/Src/update_app.c ****     update_app_conf.erase_app_toal_count = bootloader_erase_block_count;
 1546              		.loc 1 137 5 is_stmt 1 view .LVU402
 137:Core/Src/update_app.c ****     update_app_conf.erase_app_toal_count = bootloader_erase_block_count;
 1547              		.loc 1 137 42 is_stmt 0 view .LVU403
 1548 005c 9DF80320 		ldrb	r2, [sp, #3]	@ zero_extendqisi2
 1549 0060 044B     		ldr	r3, .L104+8
 1550 0062 1A73     		strb	r2, [r3, #12]
 139:Core/Src/update_app.c ****     erase_app_start();
 1551              		.loc 1 139 5 is_stmt 1 view .LVU404
 1552 0064 FFF7FEFF 		bl	erase_app_start
 1553              	.LVL124:
 140:Core/Src/update_app.c **** }
 1554              		.loc 1 140 1 is_stmt 0 view .LVU405
 1555 0068 02B0     		add	sp, sp, #8
 1556              		.cfi_def_cfa_offset 8
 1557              		@ sp needed
 1558 006a 10BD     		pop	{r4, pc}
 1559              	.L105:
 1560              		.align	2
 1561              	.L104:
 1562 006c 00280008 		.word	134227968
 1563 0070 00000000 		.word	.LC15
 1564 0074 00000000 		.word	update_app_conf
 1565 0078 14000000 		.word	.LC16
 1566              		.cfi_endproc
 1567              	.LFE7:
 1569              		.section	.rodata.update_app_start.str1.4,"aMS",%progbits,1
 1570              		.align	2
 1571              	.LC17:
 1572 0000 73746172 		.ascii	"start update app, get app size \000"
 1572      74207570 
 1572      64617465 
 1572      20617070 
 1572      2C206765 
 1573              		.section	.text.update_app_start,"ax",%progbits
 1574              		.align	1
 1575              		.global	update_app_start
 1576              		.syntax unified
 1577              		.thumb
 1578              		.thumb_func
 1580              	update_app_start:
 1581              	.LFB4:
  39:Core/Src/update_app.c **** {
 1582              		.loc 1 39 1 is_stmt 1 view -0
 1583              		.cfi_startproc
 1584              		@ args = 0, pretend = 0, frame = 0
 1585              		@ frame_needed = 0, uses_anonymous_args = 0
 1586 0000 08B5     		push	{r3, lr}
 1587              		.cfi_def_cfa_offset 8
 1588              		.cfi_offset 3, -8
 1589              		.cfi_offset 14, -4
  40:Core/Src/update_app.c ****     uart_printf(info_log, "start update app, get app size ", NULL, 0);
 1590              		.loc 1 40 5 view .LVU407
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 43


 1591 0002 0023     		movs	r3, #0
 1592 0004 1A46     		mov	r2, r3
 1593 0006 0449     		ldr	r1, .L108
 1594 0008 0220     		movs	r0, #2
 1595 000a FFF7FEFF 		bl	uart_printf
 1596              	.LVL125:
  41:Core/Src/update_app.c ****     init_app_conf();
 1597              		.loc 1 41 5 view .LVU408
 1598 000e FFF7FEFF 		bl	init_app_conf
 1599              	.LVL126:
  42:Core/Src/update_app.c ****     calcutate_app_size();
 1600              		.loc 1 42 5 view .LVU409
 1601 0012 FFF7FEFF 		bl	calcutate_app_size
 1602              	.LVL127:
  43:Core/Src/update_app.c **** }
 1603              		.loc 1 43 1 is_stmt 0 view .LVU410
 1604 0016 08BD     		pop	{r3, pc}
 1605              	.L109:
 1606              		.align	2
 1607              	.L108:
 1608 0018 00000000 		.word	.LC17
 1609              		.cfi_endproc
 1610              	.LFE4:
 1612              		.global	update_app_functions
 1613              		.section	.data.update_app_functions,"aw"
 1614              		.align	2
 1617              	update_app_functions:
 1618 0000 00FF0131 		.word	822214400
 1619 0004 00000000 		.word	erase_app_start
 1620 0008 00FF0331 		.word	822345472
 1621 000c 00000000 		.word	check_erase_app_result
 1622 0010 03020131 		.word	822149635
 1623 0014 00000000 		.word	start_install_app
 1624 0018 02020131 		.word	822149634
 1625 001c 00000000 		.word	download_app_crc_check
 1626 0020 05020131 		.word	822149637
 1627 0024 00000000 		.word	download_finish_CRC_Validate
 1628 0028 00000034 		.word	872415232
 1629 002c 00000000 		.word	pre_download_app
 1630 0030 00000036 		.word	905969664
 1631 0034 00000000 		.word	download_app
 1632 0038 00000037 		.word	922746880
 1633 003c 00000000 		.word	finish_download_app
 1634              		.global	update_app_conf
 1635              		.section	.bss.update_app_conf,"aw",%nobits
 1636              		.align	2
 1639              	update_app_conf:
 1640 0000 00000000 		.space	32
 1640      00000000 
 1640      00000000 
 1640      00000000 
 1640      00000000 
 1641              		.text
 1642              	.Letext0:
 1643              		.file 2 "Core/Inc/typedef_conf.h"
 1644              		.file 3 "Core/Inc/update_app.h"
 1645              		.file 4 "Core/Inc/uds.h"
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 44


 1646              		.file 5 "Core/Inc/uart_printf.h"
 1647              		.file 6 "Core/Inc/crc.h"
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 45


DEFINED SYMBOLS
                            *ABS*:00000000 update_app.c
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:19     .rodata.execute_update_APP_fucntion.str1.4:00000000 $d
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:26     .text.execute_update_APP_fucntion:00000000 $t
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:31     .text.execute_update_APP_fucntion:00000000 execute_update_APP_fucntion
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:147    .text.execute_update_APP_fucntion:00000060 $d
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:1617   .data.update_app_functions:00000000 update_app_functions
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:154    .text.download_app:00000000 $t
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:160    .text.download_app:00000000 download_app
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:370    .text.download_app:000000d0 $d
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:1639   .bss.update_app_conf:00000000 update_app_conf
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:375    .text.download_finish_CRC_Validate:00000000 $t
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:381    .text.download_finish_CRC_Validate:00000000 download_finish_CRC_Validate
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:465    .text.download_finish_CRC_Validate:00000054 $d
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:472    .rodata.pre_download_app.str1.4:00000000 $d
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:483    .text.pre_download_app:00000000 $t
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:489    .text.pre_download_app:00000000 pre_download_app
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:636    .text.pre_download_app:000000a8 $d
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:645    .rodata.check_erase_app_result.str1.4:00000000 $d
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:652    .text.check_erase_app_result:00000000 $t
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:658    .text.check_erase_app_result:00000000 check_erase_app_result
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:762    .text.check_erase_app_result:00000074 $d
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:771    .rodata.erase_app_start.str1.4:00000000 $d
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:778    .text.erase_app_start:00000000 $t
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:784    .text.erase_app_start:00000000 erase_app_start
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:900    .text.erase_app_start:00000074 $d
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:910    .rodata.finish_download_app.str1.4:00000000 $d
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:914    .text.finish_download_app:00000000 $t
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:920    .text.finish_download_app:00000000 finish_download_app
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:978    .text.finish_download_app:0000003c $d
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:985    .rodata.start_install_app.str1.4:00000000 $d
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:989    .text.start_install_app:00000000 $t
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:995    .text.start_install_app:00000000 start_install_app
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:1055   .text.start_install_app:0000003c $d
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:1063   .rodata.download_app_crc_check.str1.4:00000000 $d
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:1067   .text.download_app_crc_check:00000000 $t
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:1073   .text.download_app_crc_check:00000000 download_app_crc_check
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:1207   .text.download_app_crc_check:00000080 $d
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:1216   .text.init_app_conf:00000000 $t
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:1222   .text.init_app_conf:00000000 init_app_conf
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:1263   .text.init_app_conf:00000024 $d
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:1269   .rodata.update_app_entry.str1.4:00000000 $d
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:1279   .text.update_app_entry:00000000 $t
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:1285   .text.update_app_entry:00000000 update_app_entry
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:1439   .text.update_app_entry:00000090 $d
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:1449   .rodata.calcutate_app_size.str1.4:00000000 $d
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:1456   .text.calcutate_app_size:00000000 $t
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:1462   .text.calcutate_app_size:00000000 calcutate_app_size
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:1562   .text.calcutate_app_size:0000006c $d
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:1570   .rodata.update_app_start.str1.4:00000000 $d
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:1574   .text.update_app_start:00000000 $t
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:1580   .text.update_app_start:00000000 update_app_start
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:1608   .text.update_app_start:00000018 $d
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:1614   .data.update_app_functions:00000000 $d
C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s:1636   .bss.update_app_conf:00000000 $d

UNDEFINED SYMBOLS
ARM GAS  C:\Users\YLAI2\AppData\Local\Temp\ccNfjLHi.s 			page 46


uart_printf
convert_uint32_t_to_uint8_t
can_service_response
crc_reset
crc_calculate
